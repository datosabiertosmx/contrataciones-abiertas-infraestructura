<form id="add_party_form">

    <input type="text" name="contractingprocess_id" value = "<%= contractingprocess_id %>" hidden>

    <p>
        <label data-tooltip="crear_proceso" title='Nombre común por el que se conoce a esta persona física o moral, o del área de la institución pública en el procedimiento de contratación. El apartado de identificación provee un espacio para registrar el nombre formal o razón social, por lo que éste puede repetir ese valor o puede referirse al nombre común por el cual es conocida la organización.'>
        Nombre común *<!--Name--></label>
        <input name="name" type="text" class="form-control" required>
    </p>

    <p>
        <label data-tooltip="crear_proceso" title='El identificador utilizado para hacer referencias cruzadas a este actor desde otras secciones del esquema. Este campo puede ser construido de acuerdo con la siguiente estructura: {identifier.scheme} - {identifier.id} (- {department-identifier}).'>
        Identificador del actor *</label>
        <input name="partyid" type="text" class="form-control" readonly required>
    </p>
    
    <p>
        <label data-tooltip="crear_proceso" title='Cargo que ocupa el servidor público. Este campo se utiliza para definir el cargo que ocupan los servidores públicos asistentes a las juntas de aclaraciones.'>
        Cargo</label>
        <input name="position" type="text" class="form-control">
    </p>
    
    <hr>
    
    <label data-tooltip="crear_proceso" title='El identificador principal de este actor. Los identificadores que señalan exclusivamente una entidad legal deben ser preferidos. Consulte la "Orientación del identificador de la organización" para el esquema preferido y el identificador a utilizar.'>
    <h4>Identificador principal</h4></label>
    
    <p>
        <label data-tooltip="crear_proceso" title='Campo Sí/No para indicar si es persona física.'>¿Es persona física?</label>
        <select class="form-control" name="naturalperson" id="naturalperson" onchange="if(getElementById('naturalperson').selectedIndex == 1){
                document.getElementById('givenname').disabled = false; 
                document.getElementById('surname').disabled = false; 
                document.getElementById('additionalsurname').disabled = false;
                document.getElementById('identifier_legalname').disabled = true;
                $('#identifier_legalname').val('');
            } 
            else{
                document.getElementById('identifier_legalname').disabled = false;
                document.getElementById('givenname').disabled = true;
                $('#givenname').val(''); 
                document.getElementById('surname').disabled = true;
                $('#surname').val(''); 
                document.getElementById('additionalsurname').disabled = true;
                $('#additionalsurname').val('');
            }">
            
            <option value="false"
                <% if (typeof parties !== "undefined"){%>
                <%=(parties.naturalperson === false) ?'selected':''%>
                <%}%>
                >No</option>
            <option value="true"
                <% if (typeof parties !== "undefined") {%>
                <%=(parties.naturalperson) ?'selected':''%>
                <%}%>
                >Si</option>
        </select>
    </p>
     
    <br>
       
	<div class="row">
		    
    	<div class="col-sm-6">
    		
    		<label data-tooltip="crear_proceso" title='El identificador principal de este actor. Los identificadores que señalan exclusivamente una entidad legal deben ser preferidos. Consulte la "Orientación del identificador de la organización" para el esquema preferido y el identificador a utilizar.'>
    		<h4>Persona moral</h4></label>
    		
    		<p><label data-tooltip="crear_proceso" title='Nombre o razón social.'>Nombre o razón social *<!--Identifier legal name--></label>
        	<input name="identifier_legalname" id="identifier_legalname" type="text" class="form-control" required></p>
    	</div>
    	
		<div class="col-sm-6">
		
			<label data-tooltip="crear_proceso" title='El identificador principal de este actor. Los identificadores que señalan exclusivamente una entidad legal deben ser preferidos. Consulte la "Orientación del identificador de la organización" para el esquema preferido y el identificador a utilizar.'>
    		<h4>Persona física</h4></label>
    
    		<p>
        	<label data-tooltip="crear_proceso">Nombre *<!--Name--></label>
        	<input name="givenname" id="givenname" type="text" class="form-control" disabled required>
    		</p>

    		<p>
        	<label>Primer Apellido *</label>
        	<input name="surname" id="surname" type="text" class="form-control" disabled required>
	    	</p>

    		<p>
        	<label>Segundo Apellido *</label>
        	<input name="additionalsurname" id="additionalsurname" type="text" class="form-control" disabled required>
    		</p>
    	</div>
    </div>
    
    <br>



    <!-- ########################################################################## MODIFICADO ##################################### -->
    <p><label data-tooltip="crear_proceso" title='Los identificadores del actor deben extraerse de una lista de identificadores existente. El campo esquema se utiliza para indicar el nombre de la lista o registro del que se extrae el identificador. Este valor debe obtenerse de la lista de códigos "Esquema de identificación de la organización".'>
    Esquema *<!--Identifier scheme--></label>
        <select name="identifier_scheme" class="form-control" onChange="validarVacio(this);" id='identifier_scheme' required>
            <option value="">Seleccionar un esquema</option>
            <option value="MX-RFC">MX-RFC</option>
        </select>
    <!-- ########################################################################## MODIFICADO ##################################### -->


    <p><label data-tooltip="crear_proceso" title='El identificador de la persona física o moral, o del área de la institución pública.'>
    Identificador <!--Identifier id--></label>
        <input name="identifier_id" type="text" class="form-control" required></p>

    <hr>
    
    <label data-tooltip="crear_proceso" title='Domicilio de la persona física o moral, o del área de la institución pública.'>
    <h4>Domicilio</h4></label>
    
    <p><label>Tipo de vialidad</label>
        <select name="address_typeofroad" class="form-control">
            <option value="">- Seleccionar -</option>
            <option value="Ampliación">Ampliación</option>
            <option value="Andador">Andador</option>
            <option value="Avenida">Avenida</option>
            <option value="Boulevard">Boulevard</option>
            <option value="Brecha">Brecha</option>
            <option value="Calle">Calle</option>
            <option value="Callejón">Callejón</option>
            <option value="Calzada">Calzada</option>
            <option value="Camino">Camino</option>
            <option value="Carretera">Carretera</option>
            <option value="Cerrada">Cerrada</option>
            <option value="Circuito">Circuito</option>
            <option value="Circunvalación">Circunvalación</option>
            <option value="Continuación">Continuación</option>
            <option value="Corredor">Corredor</option>
            <option value="Diagonal">Diagonal</option>
            <option value="Eje vial">Eje vial</option>
            <option value="Pasaje">Pasaje</option>
            <option value="Peatonal">Peatonal</option>
            <option value="Periférico">Periférico</option>
            <option value="Privada">Privada</option>
            <option value="Prolongación">Prolongación</option>
            <option value="Retorno">Retorno</option>
            <option value="Terracería">Terracería</option>
            <option value="Vereda">Vereda</option>
            <option value="Viaducto">Viaducto</option>
        </select>
    </p>

    <p><label data-tooltip="crear_proceso" title='Nombre de vialidad. Por ejemplo, Insurgentes Sur.'>
    Nombre de vialidad</label>
        <input name="address_streetaddress" type="text" class="form-control"></p>
    
    <div class="row">        
        <div class="col-sm-6">            
            <p>
                <label data-tooltip="crear_proceso">Número exterior</label>
                <input name="address_outdoornumber" type="text" class="form-control">
            </p>
        </div>     
        <div class="col-sm-6">
            <p>
                <label data-tooltip="crear_proceso">Número interior</label>
                <input name="address_interiornumber" type="text" class="form-control">
            </p>
        </div>
    </div>

    <p><label>Tipo de asentamiento</label>
        <select name="address_typeofsettlement" class="form-control">
            <option value="">- Seleccionar -</option>
            <option value="aeropuerto">Aeropuerto</option>
            <option value="ampliacion">Ampliación</option>
            <option value="barrio">Barrio</option>
            <option value="canton">Cantón</option>
            <option value="ciudad">Ciudad</option>
            <option value="ciudadIndustrial">Ciudad industrial</option>
            <option value="colonia">Colonia</option>
            <option value="condominio">Condominio</option>
            <option value="conjuntoHabitacional">Conjunto habitacional</option>
            <option value="corredorIndustrial">Corredor industrial</option>
            <option value="coto">Coto</option>
            <option value="cuartel">Cuartel</option>
            <option value="ejido">Ejido</option>
            <option value="exhacienda">Exhacienda</option>
            <option value="fraccion">Fracción</option>
            <option value="fraccionamiento">Fraccionamiento</option>
            <option value="granja">Granja</option>
            <option value="hacienda">Hacienda</option>
            <option value="ingenio">Ingenio</option>
            <option value="manzana">Manzana</option>
            <option value="paraje">Paraje</option>
            <option value="parqueIndustrial">Parque industrial</option>
            <option value="privada">Privada</option>
            <option value="prolongacion">Prolongación</option>
            <option value="pueblo">Pueblo</option>
            <option value="puerto">Puerto</option>
            <option value="rancheria">Ranchería</option>
            <option value="rancho">Rancho</option>
            <option value="region">Región</option>
            <option value="residencial">Residencial</option>
            <option value="rinconada">Rinconada</option>
            <option value="seccion">Sección</option>
            <option value="sector">Sector</option>
            <option value="supermanzana">Supermanzana</option>
            <option value="unidad">Unidad</option>
            <option value="unidadHabitacional">Unidad habitacional</option>
            <option value="villa">Villa</option>
            <option value="zonaFederal">Zona federal</option>
            <option value="zonaIndustrial">Zona industrial</option>
            <option value="zonaMilitar">Zona militar</option>
            <option value="zonaNaval">Zona naval</option>
        </select>
    </p>

    <p><label data-tooltip="crear_proceso">Nombre del asentamiento</label>
        <input name="address_settlementname" type="text" class="form-control">
    </p>


    <p><label data-tooltip="crear_proceso" title='Entidad federativa. Por ejemplo, Ciudad de México.'>Entidad federativa<!--Address region--></label>
        <select id="address_region" name="address_region" class="form-control">
            <option value="">- Seleccionar -</option>
        </select>
    </p>
    <!--<p><label data-tooltip="crear_proceso">Clave de la Entidad federativa</label>-->
        <input id="address_regionkey" name="address_regionkey" type="hidden" class="form-control"></p>

    <p><label data-tooltip="crear_proceso" disabled>Alcaldía o municipio</label>
        <select disabled id="address_locality" name="address_locality" class="form-control">
            <option value="">- Seleccionar -</option>
        </select>

    <!--<p><label data-tooltip="crear_proceso">Clave de la Alcaldía o Municipio</label>-->
        <input id="address_alcaldiakey" name="address_alcaldiakey" type="hidden" class="form-control"></p>
    
    <p><label data-tooltip="crear_proceso">Nombre de la localidad</label>
        <select disabled id="address_locationname" name="address_locationname" class="form-control">
            <option value="">- Seleccionar -</option>
        </select>
    </p>
    <!--<p><label data-tooltip="crear_proceso">Clave de la localidad</label>-->
        <input id="address_localitykey" name="address_localitykey" type="hidden" class="form-control"></p>


    <p><label data-tooltip="crear_proceso" title='Código postal. Por ejemplo, 94043.'>
        Código postal <!--Address postal code--></label>
        <input name="address_postalcode" type="text" class="form-control" onChange="validarCodigo(this);"></p>
        
    <p><label data-tooltip="crear_proceso" title='País. Por ejemplo, México.'>
        País<!--Address country name--></label>
        <input name="address_countryname" type="text" class="form-control"></p>

    <input id="region_text" name="region_text" type="hidden" class="form-control">
    <input id="locality_text" name="locality_text" type="hidden" class="form-control">
    <input id="locationname_text" name="locationname_text" type="hidden" class="form-control">

    <hr>
    
    <h4>Domicilio en el extranjero</h4>

    <p><label data-tooltip="crear_proceso">Calle</label>
        <input name="address_streetabroad" type="text" class="form-control"></p>
            
    <p><label data-tooltip="crear_proceso">Número</label>
        <input name="address_numberabroad" type="text" class="form-control"></p>
            
    <p><label data-tooltip="crear_proceso">Ciudad</label>
        <input name="address_cityabroad" type="text" class="form-control"></p>

    <p><label data-tooltip="crear_proceso">País</label>
        <input name="address_countryabroad" type="text" class="form-control"></p>

    <hr>
    
    <label data-tooltip="crear_proceso" title='Persona o área administrativa que funge como punto de contacto en relación con este procedimiento de contratación.'>
    <h4>Punto de contacto</h4></label>
    
    <p><label>Tipo de punto de contacto</label>
        <select name="contactpoint_type" class="form-control">
            <option value="">- Seleccionar -</option>
            <option value="contactPoint">Punto de contacto</option>
            <option value="attorney">Representante legal o apoderado</option>
        </select></p>

    <p><label data-tooltip="crear_proceso" title='El nombre de la persona o área administrativa que funge como punto de contacto para recibir notificaciones en relación con este procedimiento de contratación.'>
    Nombre<!--Contact point name--></label>
        <input name="contactpoint_givenname" type="text" class="form-control"></p>
        
    <p>
        <label>
        Primer Apellido</label>
        <input name="contactpoint_surname" type="text" class="form-control">
    </p>

    <p>
        <label>
        Segundo Apellido</label>
        <input name="contactpoint_additionalsurname" type="text" class="form-control">
    </p>


    <p><label data-tooltip="crear_proceso" title='Correo electrónico del punto de contacto.'>
    Correo electrónico<!--Contact point email--></label>
        <input name="contactpoint_email"   type="text" onChange="validarEmail(this.value);" class="form-control"></p>
        
    <p><label data-tooltip="crear_proceso" title='El número de teléfono del punto de contacto / persona. Éste debe incluir el código de marcación internacional.'>
    Teléfono<!--Contact point telephone--></label>
        <input name="contactpoint_telephone"  type="text" onChange="validarSiNumero(this.value);" class="form-control"></p>
        
    <p><label data-tooltip="crear_proceso" title='El número de fax del punto de contacto / persona. Éste debe incluir el código de marcación internacional.'>
    Número de fax<!--Contact point fax number--></label>
        <input name="contactpoint_faxnumber"    type="text" class="form-control"></p>
        
    <p><label data-tooltip="crear_proceso" title='Dirección web del punto de contacto.'>
    URL<!--Contact point URL--></label>
        <input name="contactpoint_url" type="url" class="form-control"></p>
        
        <hr>
    <label data-tooltip="crear_proceso" title='El papel(es) que desempeña el actor involucrado en el procedimiento de contratación. Estos papeles deben ser tomados de la lista de códigos "Papeles de los actores". Los valores de la lista de códigos proporcionada deben usarse siempre que sea posible, aunque se pueden proporcionar otros valores si la lista de códigos no tiene uno pertinente.'>
    Papeles del actor *</label>
    
    <div class="well">
        <label class="checkbox-inline"><input name="contractingunit" type="checkbox">Área contratante</label><br>
        <label class="checkbox-inline"><input name="requestingunit" type="checkbox">Área requirente</label><br>
        <label class="checkbox-inline"><input name="technicalunit" type="checkbox">Área técnica</label><br>
        <label class="checkbox-inline"><input name="responsibleunit" type="checkbox">Área responsable de la ejecución</label><br>
        <label class="checkbox-inline"><input name="attendee" type="checkbox">Asistente a junta de aclaraciones</label><br>
        <label class="checkbox-inline"><input name="reviewBody" type="checkbox">Auditor</label><br>
        <label class="checkbox-inline"><input name="payer" type="checkbox">Emisor del pago</label><br>     
        <label class="checkbox-inline"><input name="buyer" type="checkbox">Entidad compradora</label><br>
        <label class="checkbox-inline"><input name="procuringEntity" type="checkbox">Entidad contratante</label><br>
        <label class="checkbox-inline"><input name="guarantor" type="checkbox">Institución que expide la garantía</label><br>
        <label class="checkbox-inline"><input name="tenderer" type="checkbox">Licitante</label><br>
        <label class="checkbox-inline"><input name="enquirer" type="checkbox">Persona física o moral que solicita aclaraciones</label><br>        
        <label class="checkbox-inline"><input name="issuingSupplier" type="checkbox">Persona física o moral que envía cotización (investigación de mercado)</label><br>
        <label class="checkbox-inline"><input name="invitedSupplier" type="checkbox">Persona física o moral invitada a cotizar (investigación de mercado)</label><br>
        <label class="checkbox-inline"><input name="supplier" type="checkbox">Proveedor o contratista</label><br>     
        <label class="checkbox-inline"><input name="payee" type="checkbox">Receptor de pago</label><br>
        <label class="checkbox-inline"><input name="official" type="checkbox">Servidor público asistente a junta de aclaraciones</label><br>
    </div>

    <button type="submit" class="btn btn-default">Crear</button>
</form>

<script>
    function validarSiNumero(numero){
        if (!/^([0-9])*$/.test(numero))
        alert("Solo se permiten números");
    }
  
    function validarEmail( email ) {
        expr = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        if ( !expr.test(email) )
            alert("La dirección de correo " + email + " no tiene el formato correcto.");
    }

    function validarVacio (input) {
        input.value = input.value.trim();
    }

    function validarCodigo(input){
        input.value = input.value.trim();
        if(input.value.length == 5){
            //No modifica el dato
        }else{
            alert("La longitud del código postal no es correcta. Considere que en México el código postal se compone de 5 dígitos.")
            input.value = "";
        }
    }

    $('[name="identifier_scheme"], [name="identifier_id"]').on('change', function() {
        var scheme = $('[name="identifier_scheme"]').val();
        var id = $('[name="identifier_id"]').val();

        if (scheme == '' && id == '')
            $('[name="partyid"]').val('');
        else
            $('[name="partyid"]').val(scheme + '-' + id);
    });

</script>
