<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html" xmlns="http://www.w3.org/1999/html" lang="es-MX" xml:lang="es-MX">

<head>
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-KNYE7DF2RM"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-KNYE7DF2RM');
    </script>
    <!-- End Google Analytics -->

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/contratacionesabiertas/static/bower_components/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css">
    <!-- Bootstrap core CSS -->
    <link href="/contratacionesabiertas/static/bower_components/bootstrap_4/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/contratacionesabiertas/static/bower_components/bootstrap-select/dist/css/bootstrap-select.css" rel="stylesheet">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel='stylesheet' href='/contratacionesabiertas/static/stylesheets/main.css' />
    <link rel='stylesheet' href='/contratacionesabiertas/static/stylesheets/style_d3bubble.css' />
    <link rel="stylesheet" type="text/css" href="/contratacionesabiertas/static/bower_components/jqplot/jquery.jqplot.css" />
    <link rel="stylesheet" href="/contratacionesabiertas/static/stylesheets/dashboard.css">
    <link rel="import" href="<%= process.env.CDN_URL %>/bower_components/polymer/polymer.html">
    <link rel="import" href="/contratacionesabiertas/static/inai-navbar/dgm-navbar_datos.html">
    <link rel="import" href="/contratacionesabiertas/static/inai-footer/dgm-footer.html">
    <link rel="stylesheet" type="text/css" href="/contratacionesabiertas/static/bower_components/tooltipster/dist/css/tooltipster.bundle.min.css" />
    <link rel="stylesheet" type="text/css" href="/contratacionesabiertas/static/bower_components/tooltipster-follower/dist/css/tooltipster-follower.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.8/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.6.0/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.2/FileSaver.min.js" integrity="sha512-k8F8QynmFNURwbUJC8drKA+fo3YfNvjqKzStdydD6au+MzvxBoRnxH8E31RJXwDY9DrnEiPhh9wBoDSIxhkyHQ==" crossorigin="anonymous"></script>
    <script src="/contratacionesabiertas/static/javascripts/common.js"></script>
	
	<style no-shim>        
        .navbar-default{ 
          background-color: #FFFFFF; 
          border: none;
          width: 100%;
        }
        
        .menuTopBar{
            text-align: center;
            background-color: #00bfa5;
            position: fixed;
            z-index: 4;
            top: 106.5px;
            max-width: none;
            width: 100%;
            padding: 0 10% 0;
        }
        .menuTopBar a{
            height: 52px;
            text-decoration: none;
            font-size: 15px;
            vertical-align: middle;
            color: #FFFFFF;
        }
        .menuTopBar .botonMenuTop:hover{
            background-color: #008e76;
            height: 52px;
        }
        .menuTopBar .botonMenuTop{
            width: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            background-color: #00bfa5;
            color: #ffffff;
        }
        @media (max-width: 991px) {
            body {
                margin: 150px 0 0;
            }
            .menuTopBarS{
                padding: 0 0 0;
                background-color: black;
            }
        }
    </style>

    <title>Datos abiertos</title>
</head>

<body>
    <dgm-navbar></dgm-navbar>
    
    <div class="menuTopBar menuTopBarS row" style="margin-left: 0">
        <div class="col-md-3 col-xs-3" style="padding: 0 0 0;">
            <a href="/contratacionesabiertas/contratos/" class="botonMenuTop">Inicio</a>
        </div>
        <div class="col-md-3 col-xs-3" style="padding: 0 0 0;">
            <a href="/contratacionesabiertas/politicadepublicacion" class="botonMenuTop">Política de publicación</a>
        </div>
        <div class="col-md-3 col-xs-3" style="padding: 0 0 0;">
            <a href="/contratacionesabiertas/implementa" class="botonMenuTop">Implementa el EDCA-MX</a>
        </div>
        <div class="col-md-3 col-xs-3" style="padding: 0 0 0;">
            <a href="/contratacionesabiertas/datosabiertos" class="botonMenuTop" style="background-color: #008e76">Datos abiertos</a>
        </div>
    </div>
    <nav class="navbar navbar-default navbar-fixed-top hidden-sm hidden-xs" style="position: fixed; z-index: 4;">
      <div class="container"> 
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="/contratacionesabiertas/"><i class="fas fa-home"></i></a></li>
          <li class="breadcrumb-item"><a href="/contratacionesabiertas/contratos/">Instituto Nacional de Transparencia, Acceso a la Información y Protección de Datos Personales</a></li>
          <li class="breadcrumb-item active" style="color: #00bfa5;" aria-current="page">Datos abiertos</li>
        </ol>
    </div>
    </nav>

    <div class="container">
      <div class="row">
        <div class="col-md-12 post">
          <div ng-bind-html="content" class="content ng-binding">
            <br><br><br>
                <h4><strong>Descarga los datos abiertos de las contrataciones públicas</strong></h4>
                <br>             
          </div>
          <div id="accordion">
            <div class="card">
              <div class="card-header" id="headingOne">
                <h5 class="mb-0">
                  <h4 class="collapsed" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne" style="cursor: pointer;">
                    Descarga todos los procesos de contratación relacionados al método de contratación
                  </h4>
                </h5>
              </div>
              <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-parent="#accordion">
                <div class="card-body">
                  <div class="row">
                    <div class="col-md-1">
                      <button type="button" class="btn btn-primary btn-sm btn-block" data-toggle="collapse" href="#parameters1" aria-expanded="false" aria-controls="parameters1">
                        <a class="font-weight-bold">GET</a>
                      </button>
                    </div>
                    <div class="col-md-11 font-weight-bold" data-toggle="collapse" href="#parameters1" aria-expanded="false" aria-controls="parameters1" style="cursor: pointer;">
                      /edca/contractingprocess/procurementmethod/{procurementmethod}/{year}
                      <p>Método para obtener datos abiertos de las contrataciones relacionadas al método de contratación solicitado.</p>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col">
                      <div class="collapse multi-collapse" id="parameters1">
                        <div class="card-body">
                          <div class="d-flex font-weight-bold">
                              Parámetros
                              <a id="primero" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:visible; display:block;" onclick="visualiza_segundo('primero','segundo','disabledSelect','yearProcurementMethod','ejecutar/limpiar')">Consultar</a>
                              <a id="segundo" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:hidden; display:none; background-color:#FF0000;" onclick="visualiza_primero('primero','segundo','disabledSelect','yearProcurementMethod','ejecutar/limpiar')">Cancelar</a>
                          </div>
                        </div>
                      
                          <script type="text/javascript">
                            
                          </script>

                        <table class="table">
                          <thead>
                            <tr>
                              <th style="width: 250px;" scope="col">Nombre</th>
                              <th scope="col">Descripción</th>
                            </tr>
                          </thead>
                          <tbody>
                              <tr>
                                <th >
                                  <a class="font-weight-bold">procurementmethod <sup style="color:#FF0000">* requerido</sup></a>
                                  <a class="d-flex font-weight-bold" style="font-size:12px;">array[string]</a>
                                  <i style="font-size:10px; font-weight: normal;">(path)</i></th>
                                <td>
                                  <p>Filtro que permite la consulta de los procesos según el método de contratación utilizado. El resultado de la consulta contendrá todos los procesos publicados en este sitio, incluyendo aquellos que fueron declarados desiertos o cancelados, así como aquellos que aún no han sido formalizados.</p>
                                  <p>Valores disponibles: Adjudicación directa, Invitación a cuando menos tres personas, Licitación pública</p>
                                  <select id="disabledSelect" name="procurementmethod" class="custom-select" size="4" style="width: 350px;" multiple required disabled>
                                    <option value="Adjudicación directa">Adjudicación directa</option>
                                    <option value="Invitación a cuando menos tres personas">Invitación a cuando menos tres personas</option>
                                    <option value="Licitación pública">Licitación pública</option>
                                  </select>
                                  <br><br>
                                </td>
                              </tr>
                              <tr>
                                <th >
                                  <a class="font-weight-bold">year </a>
                                  <a class="d-flex font-weight-bold" style="font-size:12px;">array[string]</a>
                                  <i style="font-size:10px; font-weight: normal;">(path)</i></th>
                                <td>
                                  <p>Filtro que permite la consulta de los procesos según la fecha de firma del contrato. Este filtro es opcional; al incluirlo en la búsqueda, el resultado contendrá solamente los procesos formalizados.</p>
                                  <p id="aniosText"></p>
                                  <select id="yearProcurementMethod" name="year" class="custom-select" size="4" style="width: 350px;" multiple  disabled></select>
                                  <br><br>
                                </td>
                              </tr>
                              <tr id="ejecutar/limpiar" hidden>
                                <td colspan="2" style="border: white;"><button id="leyendo_1" class="btn btn-primary btn-lg btn-block" style="background-color:#4990e2;" onclick="getProcurementMethod()">Consultar</button>
                                <button id="leyendo_2" class="btn btn-primary btn-lg btn-block" style="background-color:#4990e2;" hidden disabled><span class="spinner-border spinner-border-sm"></span>
                                  Procesando ...</button></td>
                                <td colspan="2" style="border: white;"><button id="clean" class="btn btn-primary btn-lg btn-block" style="background-color:#FF0000;" onclick="clean('procurementmethodRes','codeprocurementmethod','desprocurementmethod','clean','disabledSelect','yearProcurementMethod','leyendo_1','leyendo_2')" hidden>Limpiar</button></td>
                              </tr>
                              <tr>
                                <th scope="row">Respuesta</th>
                                <td>
                                  <textarea id="procurementmethodRes" name="textarea" class="form-control" rows="10" cols="100" readonly></textarea>
                                  <a id="downloadAnchorElem" style="display:none"></a>                                  
                                </td>
                              </tr>
                              <tr>
                                <th scope="row">Formatos de descargas</th>
                                <td>
                                  <div class="container">
                                    <div class="row">
                                      <button class="btn btn-primary btn-sm font-weight-bold" style="visibility:visible; display:block;" onclick="copyResult('procurementmethodRes')">Copiar contenido</button>
                                      <button id="downlo" class="btn btn-primary btn-sm ml-3 font-weight-bold" style="visibility:visible; display:block;" onclick="downloadJSON('procurementmethod')">Descargar JSON</button>
                                      <button id="downlo_6" class="btn btn-primary btn-sm ml-3 font-weight-bold" style="visibility:visible; display:block;" onclick="downloadCSV('procurementmethod')">Descargar CSV</button>
                                      <button id="downlo_7" class="btn btn-primary btn-sm ml-3 font-weight-bold" style="visibility:visible; display:block;" onclick="downloadXLS('procurementmethod')">Descargar EXCEL</button>
                                    </div>
                                  </div>
                                  <div id="downley" class="spinner-border" role="status" hidden>
                                    <span class="sr-only">Loading...</span>
                                  </div>                                  
                                </td>
                              </tr>
                              <tr>
                                <th scope="row">Código</th>
                                <td class="font-weight-bold">Descripción</td>
                              </tr>
                              <tr>
                                <td scope="row" id="codeprocurementmethod">Resultado</td>
                                <td id="desprocurementmethod">Resultado</td>
                              </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="card">
                <div class="card-header" id="headingTwo">
                  <h5 class="mb-0">
                    <h4 class="collapsed" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo" style="cursor: pointer;">
                      Descarga todos los procesos de contratación relacionados a la categoría de contratación
                    </h4>
                  </h5>
                </div>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-1">
                        <button type="button" class="btn btn-primary btn-sm btn-block" data-toggle="collapse" href="#parameters2" aria-expanded="false" aria-controls="parameters2">
                          <a class="font-weight-bold">GET</a>
                        </button>
                      </div>
                      <div class="col-md-11 font-weight-bold" data-toggle="collapse" href="#parameters2" aria-expanded="false" aria-controls="parameters2" style="cursor: pointer;">
                        /edca​/contractingprocess​/additionalprocurementcategories​/{additionalprocurementcategories}/{year}
                        <p>Método para obtener datos abiertos de las contrataciones relacionadas a la categoría de contratación solicitado.</p>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col">
                        <div class="collapse multi-collapse" id="parameters2">
                          <div class="card-body">
                            <div class="d-flex font-weight-bold">
                                Parámetros
                                <a id="primero_2" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:visible; display:block;" onclick="visualiza_segundo('primero_2','segundo_2','disabledSelect_2','yearAdditionalProcurementCategories','ejecutar/limpiar_2')">Consultar</a>
                                <a id="segundo_2" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:hidden; display:none; background-color:#FF0000;" onclick="visualiza_primero('primero_2','segundo_2','disabledSelect_2','yearAdditionalProcurementCategories','ejecutar/limpiar_2')">Cancelar</a>
                            </div>
                          </div>
                        
                            <script type="text/javascript">
                              
                            </script>
                          <table class="table">
                            <thead>
                              <tr>
                                <th style="width: 250px;" scope="col">Nombre</th>
                                <th scope="col">Descripción</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th scope="row">
                                  <a class="font-weight-bold">additionalprocurementcategories <sup style="color:#FF0000">* requerido</sup></a>
                                  <a class="d-flex font-weight-bold" style="font-size:12px;">array[string]</a>
                                  <i style="font-size:10px; font-weight: normal;">(path)</i></th>
                                <td>
                                  <p>Filtro que permite la consulta de los procesos según la categoría de contratación a la que correspondan.  El resultado de la consulta contendrá todos los procesos publicados en este sitio, incluyendo aquellos que fueron declarados desiertos o cancelados, así como aquellos que aún no han sido formalizados.</p>
                                  <p>Valores disponibles: Adquisición de bienes, Arrendamiento de bienes, Obras públicas, Servicios, Servicios relacionados con obras públicas</p>
                                  <select id="disabledSelect_2" name="additionalprocurementcategories" class="custom-select" size="4" style="width: 350px;" multiple required disabled>
                                    <option value="Adquisición de bienes">Adquisición de bienes</option>
                                    <option value="Arrendamiento de bienes">Arrendamiento de bienes</option>
                                    <option value="Obras públicas">Obras públicas</option>
                                    <option value="Servicios">Servicios</option>
                                    <option value="Servicios relacionados con obras públicas">Servicios relacionados con obras públicas</option>
                                  </select>
                                  <br><br>
                                </td>
                              </tr>
                              <tr>
                                <th >
                                  <a class="font-weight-bold">year </a>
                                  <a class="d-flex font-weight-bold" style="font-size:12px;">array[string]</a>
                                  <i style="font-size:10px; font-weight: normal;">(path)</i></th>
                                <td>
                                  <p>Filtro que permite la consulta de los procesos según la fecha de firma del contrato. Este filtro es opcional; al incluirlo en la búsqueda, el resultado contendrá solamente los procesos formalizados.</p>
                                  <p id="aniosText2"></p>
                                  <select id="yearAdditionalProcurementCategories" name="year" class="custom-select" size="4" style="width: 350px;" multiple  disabled></select>
                                  <br><br>
                                </td>
                              </tr>
                              <tr id="ejecutar/limpiar_2" hidden>
                                <td colspan="2" style="border: white;"><button id="leyendo_3" type="button" class="btn btn-primary btn-lg btn-block" style="background-color:#4990e2;" onclick="getAdditionalProcurementCategories()">Consultar</button>
                                  <button id="leyendo_4" class="btn btn-primary btn-lg btn-block" style="background-color:#4990e2;" hidden disabled><span class="spinner-border spinner-border-sm"></span>
                                    Procesando ...</button></td>
                                <td colspan="2" style="border: white;"><button id="clean_2" class="btn btn-primary btn-lg btn-block" style="background-color:#FF0000;" onclick="clean('additionalProcurementCategoriesRes','codeadditionalprocurementcategories','desadditionalprocurementcategories','clean_2','disabledSelect_2','yearAdditionalProcurementCategories','leyendo_3','leyendo_4')" hidden>Limpiar</button></td>
                              </tr>
                              <tr>
                                <th scope="row">Respuesta</th>
                                <td>
                                  <textarea id="additionalProcurementCategoriesRes" name="textarea" class="form-control" rows="10" cols="100" readonly></textarea>
                                  <a id="downloadAnchorElem" style="display:none"></a>
                                  </div>
                                </td>
                              </tr>
                              <tr>
                                <th scope="row">Formatos de descargas</th>
                                <td>
                                  <div class="container">
                                    <div class="row">
                                      <button class="btn btn-primary btn-sm font-weight-bold" style="visibility:visible; display:block;" onclick="copyResult('additionalProcurementCategoriesRes')">Copiar contenido</button>
                                      <button id="downlo_2" class="btn btn-primary btn-sm ml-3 font-weight-bold" style="visibility:visible; display:block;" onclick="downloadJSON('additionalprocurementcategories')">Descargar JSON</button>
                                      <button id="downlo_5" class="btn btn-primary btn-sm ml-3 font-weight-bold" style="visibility:visible; display:block;" onclick="downloadCSV('additionalprocurementcategories')">Descargar CSV</button>
                                      <button id="downlo_8" class="btn btn-primary btn-sm ml-3 font-weight-bold" style="visibility:visible; display:block;" onclick="downloadXLS('additionalprocurementcategories')">Descargar EXCEL</button>
                                    </div>
                                  </div>
                                  <div id="downley_2" class="spinner-border" role="status" hidden>
                                    <span class="sr-only">Loading...</span>
                                  </div>                                  
                                </td>
                              </tr>
                              <tr>
                                <th scope="row">Código</th>
                                <td class="font-weight-bold">Descripción</td>
                              </tr>
                              <tr>
                                <td scope="row" id="codeadditionalprocurementcategories">Resultado</td>
                                <td id="desadditionalprocurementcategories">Resultado</td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="card">
                <div class="card-header" id="headingThree">
                  <h5 class="mb-0">
                    <h4 class="collapsed" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree" style="cursor: pointer;">
                      Descarga todos los procesos de contratación 
                    </h4>
                  </h5>
                </div>
                <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-1">
                        <button type="button" class="btn btn-primary btn-sm btn-block" data-toggle="collapse" href="#parameters3" aria-expanded="false" aria-controls="parameters3">
                          <a class="font-weight-bold">GET</a>
                        </button>
                      </div>
                      <div class="col-md-11 font-weight-bold" data-toggle="collapse" href="#parameters3" aria-expanded="false" aria-controls="parameters3" style="cursor: pointer;">
                        /edca​/contractingprocess​/{year}
                        <p>Método para obtener datos abiertos de todas las contrataciones.</p>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col">
                        <div class="collapse multi-collapse" id="parameters3">
                          <div class="card-body">
                            <div class="d-flex font-weight-bold">
                                Parámetros
                                <a id="primero_3" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:visible; display:block;" onclick="visualiza_segundo('primero_3','segundo_3',null,'yearContractingProcess​','ejecutar/limpiar_3')">Consultar</a>
                                <a id="segundo_3" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:hidden; display:none; background-color:#FF0000;" onclick="visualiza_primero('primero_3','segundo_3',null,'yearContractingProcess​','ejecutar/limpiar_3')">Cancelar</a>
                            </div>
                          </div>
                        
                            <script type="text/javascript">
                              
                            </script>
  
                          <table class="table">
                            <tbody>
                              <tr>
                                <th >
                                  <a class="font-weight-bold">year </a>
                                  <a class="d-flex font-weight-bold" style="font-size:12px;">array[string]</a>
                                  <i style="font-size:10px; font-weight: normal;">(path)</i></th>
                                <td>
                                  <p>Filtro que permite la consulta la información según el año de la fecha de firma del contrato. Este filtro es opcional, al incluirlo en la consulta el resultado mostrará solo los procesos que han sido formalizados. En caso de no seleccionar un año,  el resultado de la consulta contendrá todos los procesos publicados en este sitio, incluyendo aquellos que fueron declarados desiertos o cancelados, así como aquellos que aún no han sido formalizados.</p>
                                  <p id="aniosText3"></p>
                                  <select id="yearContractingProcess​" name="year" class="custom-select" size="4" style="width: 350px;" multiple disabled></select>
                                  <br><br>
                                </td>
                              </tr>
                              <tr id="ejecutar/limpiar_3" hidden>
                                <td colspan="2" style="border: white;"><button id="leyendo_5" type="button" class="btn btn-primary btn-lg btn-block" style="background-color:#4990e2;" onclick="getContractingProcess()">Consultar</button>
                                  <button id="leyendo_6" class="btn btn-primary btn-lg btn-block" style="background-color:#4990e2;" hidden disabled><span class="spinner-border spinner-border-sm"></span>
                                    Procesando ...</button></td>
                                <td colspan="2" style="border: white;"><button id="clean_3" class="btn btn-primary btn-lg btn-block" style="background-color:#FF0000;" onclick="clean('contractingprocessRes','codecontractingprocess','descontractingprocess','clean_3',null,'yearContractingProcess​','leyendo_5','leyendo_6')" hidden>Limpiar</button></td>
                              </tr>
                              <tr>
                                <th scope="row">Respuesta</th>
                                <td>
                                  <textarea id="contractingprocessRes" name="textarea" class="form-control" rows="10" cols="100" readonly></textarea>
                                  <a id="downloadAnchorElem" style="display:none"></a>
                                </td>
                              </tr>
                              <tr>
                                <th scope="row">Formatos de descargas</th>
                                <td>
                                  <div class="container">
                                    <div class="row">
                                      <button class="btn btn-primary btn-sm font-weight-bold" style="visibility:visible; display:block;" onclick="copyResult('contractingprocessRes')">Copiar contenido</button>
                                      <button id="downlo_3" class="btn btn-primary btn-sm ml-3 font-weight-bold" style="visibility:visible; display:block;" onclick="downloadJSON('contractingprocess')">Descargar JSON</button>
                                      <button id="downlo_4" class="btn btn-primary btn-sm ml-3 font-weight-bold" style="visibility:visible; display:block;" onclick="downloadCSV('contractingprocess')">Descargar CSV</button>
                                      <button id="downlo_9" class="btn btn-primary btn-sm ml-3 font-weight-bold" style="visibility:visible; display:block;" onclick="downloadXLS('contractingprocess')">Descargar EXCEL</button>
                                  </div>
                                  <div id="downley_3" class="spinner-border" role="status" hidden>
                                    <span class="sr-only">Loading...</span>
                                  </div>                                  
                                </td>
                              </tr>
                              <tr>
                                <th scope="row">Código</th>
                                <td class="font-weight-bold">Descripción</td>
                              </tr>
                              <tr>
                                <td scope="row" id="codecontractingprocess">Resultado</td>
                                <td id="descontractingprocess">Resultado</td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!--Todos los Record Packages-->
              <div class="card">
                <div class="card-header" id="headingSix">
                  <h5 class="mb-0">
                    <h4 class="collapsed" data-toggle="collapse" data-target="#collapseSix" aria-expanded="false" aria-controls="collapseSix" style="cursor: pointer;">
                      Todos los procesos de contratación (Histórico) 
                    </h4>
                  </h5>
                </div>
                <div id="collapseSix" class="collapse" aria-labelledby="headingSix" data-parent="#accordion">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-1">
                        <button type="button" class="btn btn-primary btn-sm btn-block" data-toggle="collapse" href="#parameters6" aria-expanded="false" aria-controls="parameters6">
                          <a class="font-weight-bold">GET</a>
                        </button>
                      </div>
                      <div class="col-md-11 font-weight-bold" data-toggle="collapse" href="#parameters6" aria-expanded="false" aria-controls="parameters6" style="cursor: pointer;">
                        /edca/recordPackages/{year}
                        <p>Método para obtener datos de las contrataciones públicas según el año de la fecha de firma del contrato. Este conjunto de datos contiene todas las liberaciones históricas y vigentes que han tenido los procesos de contratación de acuerdo al esquema del paquete de registros (record package) del EDCA-MX.</p>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col">
                        <div class="collapse multi-collapse" id="parameters6">
                          <div class="card-body">
                            <div class="d-flex font-weight-bold">
                                Parámetros
                                <a id="primero_6" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:visible; display:block;" onclick="visualiza_segundo('primero_6','segundo_6',null,'yearRecordPackage','ejecutar/limpiar_6')">Consultar</a>
                                <a id="segundo_6" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:hidden; display:none; background-color:#FF0000;" onclick="visualiza_primero('primero_6','segundo_6',null,'yearRecordPackage','ejecutar/limpiar_6')">Cancelar</a>
                            </div>
                          </div>
                      
                          <table class="table">
                            <tbody>
                              <tr>
                                <th >
                                  <a class="font-weight-bold">year </a>
                                  <a class="d-flex font-weight-bold" style="font-size:12px;">array[string]</a>
                                  <i style="font-size:10px; font-weight: normal;">(path)</i></th>
                                <td>
                                  <p>Filtro que permite la consulta la información según el año de la fecha de firma del contrato. Este filtro es opcional, al incluirlo en la consulta el resultado mostrará solo los procesos que han sido formalizados. En caso de no seleccionar un año,  el resultado de la consulta contendrá todos los procesos publicados en este sitio, incluyendo aquellos que fueron declarados desiertos o cancelados, así como aquellos que aún no han sido formalizados.</p>
                                  <p id="aniosText4"></p>
                                  <select id="yearRecordPackage" name="year" class="custom-select" size="4" style="width: 350px;" multiple disabled></select>
                                  <br><br>
                                </td>
                              </tr>
                              <tr id="ejecutar/limpiar_6" hidden>
                                <td colspan="2" style="border: white;"><button id="leyendo_8" type="button" class="btn btn-primary btn-lg btn-block" style="background-color:#4990e2;" onclick="getRecordPackages()">Consultar</button>
                                  <button id="leyendo_7" class="btn btn-primary btn-lg btn-block" style="background-color:#4990e2;" hidden disabled><span class="spinner-border spinner-border-sm"></span>
                                    Procesando ...</button></td>
                                <td colspan="2" style="border: white;"><button id="clean_6" class="btn btn-primary btn-lg btn-block" style="background-color:#FF0000;" onclick="clean('recordPackagesRes','coderecordpackages','desrecordpackages','clean_6',null,'yearRecordPackage','leyendo_8','leyendo_7')" hidden>Limpiar</button></td>
                              </tr>
                              <tr>
                                <th scope="row">Respuesta</th>
                                <td>
                                  <textarea id="recordPackagesRes" name="textarea" class="form-control" rows="10" cols="100" readonly></textarea>
                                  <a id="downloadAnchorElem" style="display:none"></a>
                                </td>
                              </tr>
                              <tr>
                                <th scope="row">Formatos de descargas</th>
                                <td>
                                  <div class="container">
                                    <div class="row">
                                      <button class="btn btn-primary btn-sm font-weight-bold" style="visibility:visible; display:block;" onclick="copyResult('recordPackagesRes')">Copiar contenido</button>
                                      <button id="downlo_10" class="btn btn-primary btn-sm ml-3 font-weight-bold" style="visibility:visible; display:block;" onclick="downloadJSON('recordPackagesRes')">Descargar JSON</button>
                                  </div>
                                  <div id="downley_4" class="spinner-border" role="status" hidden>
                                    <span class="sr-only">Loading...</span>
                                  </div>                                  
                                </td>
                              </tr>
                              <tr>
                                <th scope="row">Código</th>
                                <td class="font-weight-bold">Descripción</td>
                              </tr>
                              <tr>
                                <td scope="row" id="coderecordpackages">Resultado</td>
                                <td id="desrecordpackages">Resultado</td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- <div class="card">
                <div class="card-header" id="headingFour">
                  <h5 class="mb-0">
                    <h4 class="collapsed" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour" style="cursor: pointer;">
                      Buscar todos los proyectos.
                    </h4>
                  </h5>
                </div>
                <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-parent="#accordion">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-1">
                        <button type="button" class="btn btn-primary btn-sm btn-block" data-toggle="collapse" href="#parameters4" aria-expanded="false" aria-controls="parameters4">
                          <a class="font-weight-bold">GET</a>
                        </button>
                      </div>
                      <div class="col-md-11 font-weight-bold" data-toggle="collapse" href="#parameters4" aria-expanded="false" aria-controls="parameters4" style="cursor: pointer;">
                        /edcapi/project/
                        <p>Método que devuelve un listado de objetos del tipo PROJECT.</p>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col">
                        <div class="collapse multi-collapse" id="parameters4">
                          <div class="card-body">
                            <div class="d-flex font-weight-bold">
                                Parámetros
                                <a id="primero_4" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:visible; display:block;" onclick="visualiza_segundo_4()">Consultar</a>
                                <a id="segundo_4" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:hidden; display:none; background-color:#FF0000;" onclick="visualiza_primero_4()">Cancelar</a>
                            </div>
                          </div>
                        
                            <script type="text/javascript">
                              function visualiza_primero_4() {
                                  document.getElementById('primero_4').style.visibility='visible';
                                  document.getElementById('primero_4').style.display='block';
                                  document.getElementById('segundo_4').style.visibility='hidden';
                                  document.getElementById('segundo_4').style.display='none';
                                  document.getElementById("ejecutar/limpiar_4").hidden = true;
                              };
                              function visualiza_segundo_4() {
                                  document.getElementById('segundo_4').style.visibility='visible';
                                  document.getElementById('segundo_4').style.display='block';
                                  document.getElementById('primero_4').style.visibility='hidden';
                                  document.getElementById('primero_4').style.display='none';
                                  document.getElementById("ejecutar/limpiar_4").hidden = false;
                              };
                            </script>
  
                          <table class="table">
                            <tbody>
                              <tr>
                                <th scope="row">
                                  <a style="font-weight: normal;">Sin parámetros</a>
                                <td>
                                  <br><br>
                                </td>
                              </tr>
                              <tr id="ejecutar/limpiar_4" hidden>
                                <td colspan="2" style="border: white;"><button type="button" class="btn btn-primary btn-lg btn-block" style="background-color:#4990e2;">Consultar</button></td>
                                <td colspan="2" style="border: white;"><button id="clean_4" class="btn btn-primary btn-lg btn-block" style="background-color:#FF0000;" onclick="clean_4()" hidden>Limpiar</button></td>
                              </tr>
                              <tr>
                                <th scope="row">Respuesta</th>
                                <td></td>
                              </tr>
                              <tr>
                                <th scope="row">Código</th>
                                <td class="font-weight-bold">Descripción</td>
                              </tr>
                              <tr>
                                <td scope="row">Resultado</td>
                                <td>Resultado</td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="card">
                <div class="card-header" id="headingFive">
                  <h5 class="mb-0">
                    <h4 class="collapsed" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive" style="cursor: pointer;">
                      Buscar proyecto por identificador.
                    </h4>
                  </h5>
                </div>
                <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-parent="#accordion">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-md-1">
                        <button type="button" class="btn btn-primary btn-sm btn-block" data-toggle="collapse" href="#parameters5" aria-expanded="false" aria-controls="parameters5">
                          <a class="font-weight-bold">GET</a>
                        </button>
                      </div>
                      <div class="col-md-11 font-weight-bold" data-toggle="collapse" href="#parameters5" aria-expanded="false" aria-controls="parameters5" style="cursor: pointer;">
                        /edcapi​/project​/{id}
                        <p>Método que devuelve el proyecto relacionado al identificador proporcionado.</p>
                      </div>
                    </div>

                    <div class="row">
                      <div class="col">
                        <div class="collapse multi-collapse" id="parameters5">
                          <div class="card-body">
                            <div class="d-flex font-weight-bold">
                                Parámetros
                                <a id="primero_5" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:visible; display:block;" onclick="visualiza_segundo_5()">Consultar</a>
                                <a id="segundo_5" href="#" class="btn btn-primary btn-sm ml-auto font-weight-bold" style="visibility:hidden; display:none; background-color:#FF0000;" onclick="visualiza_primero_5()">Cancelar</a>
                            </div>
                          </div>
                        
                            <script type="text/javascript">
                              function visualiza_primero_5() {
                                  document.getElementById('primero_5').style.visibility='visible';
                                  document.getElementById('primero_5').style.display='block';
                                  document.getElementById('segundo_5').style.visibility='hidden';
                                  document.getElementById('segundo_5').style.display='none';
                                  document.getElementById("id_project").disabled = true;
                                  document.getElementById("disabledSelect_5").disabled = true;
                                  document.getElementById("ejecutar/limpiar_5").hidden = true;
                              };
                              function visualiza_segundo_5() {
                                  document.getElementById('segundo_5').style.visibility='visible';
                                  document.getElementById('segundo_5').style.display='block';
                                  document.getElementById('primero_5').style.visibility='hidden';
                                  document.getElementById('primero_5').style.display='none';
                                  document.getElementById("id_project").disabled = false;
                                  document.getElementById("disabledSelect_5").disabled = false;
                                  document.getElementById("ejecutar/limpiar_5").hidden = false;
                              };
                            </script>
  
                          <table class="table">
                            <thead>
                              <tr>
                                <th style="width: 250px;" scope="col">Nombre</th>
                                <th scope="col">Descripción</th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                <th scope="row">
                                  <a class="font-weight-bold">id <sup style="color:#FF0000">* requerido</sup></a>
                                  <a class="d-flex font-weight-bold" style="font-size:12px;">integer</a>
                                  <i style="font-size:10px; font-weight: normal;">(path)</i>
                                  <br><br>
                                  <a class="font-weight-bold">Estatus <sup style="color:#FF0000">* requerido</sup></a>
                                  <a class="d-flex font-weight-bold" style="font-size:12px;">array[string]</a>
                                  <i style="font-size:10px; font-weight: normal;">(query)</i></th>
                                <td>
                                  <p>Identificador del proyecto</p>                                 
                                  <input type="text" class="form-control" id="id_project" placeholder="id - identificador del proyecto" disabled>
                                  <br>
                                  <p>Valores de estado que deben tenerse en cuenta para el filtro</p>
                                  <select id="disabledSelect_5" class="custom-select" size="4" style="width: 350px;" disabled>
                                    <option value="1">Disponible</option>
                                    <option value="2">Pendiente</option>
                                    <option value="3">Vendido</option>
                                  </select>
                                  <br><br>
                                </td>
                              </tr>
                              <tr id="ejecutar/limpiar_5" hidden>
                                <td colspan="2" style="border: white;"><button type="button" class="btn btn-primary btn-lg btn-block" style="background-color:#4990e2;">Consultar</button></td>
                                <td colspan="2" style="border: white;"><button id="clean_5" class="btn btn-primary btn-lg btn-block" style="background-color:#FF0000;" onclick="clean5()" hidden>Limpiar</button></td>
                              </tr>
                              <tr>
                                <th scope="row">Respuesta</th>
                                <td></td>
                              </tr>
                              <tr>
                                <th scope="row">Código</th>
                                <td class="font-weight-bold">Descripción</td>
                              </tr>
                              <tr>
                                <td scope="row">Resultado</td>
                                <td>Resultado</td>
                              </tr>
                            </tbody>
                          </table>
                        </div>
                      </div>
                    </div>  
                  </div>
                </div>
              </div> -->
            </div>  
          </div>
        </div>  
      </div>    
    </div>
	<br>
	<br>

    <dgm-footer></dgm-footer>
    <script src="/contratacionesabiertas/static/bower_components/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="/contratacionesabiertas/static/bower_components/bootstrap_4/dist/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="<%= process.env.CDN_URL %>/bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    
    <script type="text/javascript">
    $(document).ready(function() {
      var uri = globals.site.url;
      var port = globals.site.port;
      var endPointFiscalYear = '/edca/fiscalYears';
      
      $.ajax({
          url: `${uri}:${port}${endPointFiscalYear}`,
          type: 'GET',
          success: function(data){ 
            var arrayYears = new Array();
            var anios = "";
            var count = 1;
            data.fiscalYears.forEach(element => {
              arrayYears.push(element.year);
              if(count == data.fiscalYears.length){
                anios +=  element.year +".";
              }else{
                anios +=  element.year +", ";
              }
                $('#yearProcurementMethod').append('<option value="'+element.year+'">'+element.year+'</option>');
                $('#yearAdditionalProcurementCategories').append('<option value="'+element.year+'">'+element.year+'</option>');
                $('#yearContractingProcess​').append('<option value="'+element.year+'">'+element.year+'</option>');
                $('#yearRecordPackage').append('<option value="'+element.year+'">'+element.year+'</option>');
              count++;
            });
            if(arrayYears.length > 0){
              $('#aniosText').append(`Registros disponibles de los periodos: ${anios}`);
              $('#aniosText2').append(`Registros disponibles de los periodos: ${anios}`);
              $('#aniosText3').append(`Registros disponibles de los periodos: ${anios}`);
              $('#aniosText4').append(`Registros disponibles de los periodos: ${anios}`);
            }
          },
          error: function(data) {
              $('#yearProcurementMethod').append('<option value=""> Not Found </option>');
              $('#yearAdditionalProcurementCategories').append('<option value=""> Not Found </option>');
              $('#yearContractingProcess​').append('<option value=""> Not Found </option>');
              $('#yearRecordPackage').append('<option value=""> Not Found </option>');
          }
      });
    });
    </script>
    <script type="text/javascript">
    var uri = globals.site.url;
    var port = globals.site.port;
    var endPointProcurementMethod = '/edca/contractingprocess/procurementmethod/';
    var endPointAdditionalProcurementCategories = '/edca/contractingprocess/additionalprocurementcategories/';
    var endPointContractingProcess = '/edca/contractingprocess/';
    var endPointRecordPackages = '/edca/recordPackages/';
    var arrayFilesCSV = new Array();
      function getProcurementMethod(){
        var parametro = $("#disabledSelect").val();
        var year = $("#yearProcurementMethod").val();

        if (parametro === null){
          alert('Selecciona al menos un tipo de contratación');
          return;
          } else {
              $.ajax({
                  url: `${uri}:${port}${endPointProcurementMethod}${parametro}/${year}`,
                  type: 'GET',
                  success: function(data){ 
                    $("#procurementmethodRes").val('');
                    $("#procurementmethodRes").val(JSON.stringify(data, null, 4));
                    $("#codeprocurementmethod").text(200);
                    $("#desprocurementmethod").text(`Success`);
                    document.getElementById('leyendo_2').hidden=true;
                    document.getElementById('clean').hidden=false;
                  },
                  error: function(data) {
                    $("#procurementmethodRes").val('Not Found');
                    $("#codeprocurementmethod").text(404);
                    $("#desprocurementmethod").text(`Not Found`);
                    document.getElementById('leyendo_2').hidden=true;
                    document.getElementById('clean').hidden=false;
                  }
              });
            }
        document.getElementById('leyendo_2').style.visibility='visible';
        document.getElementById('leyendo_2').style.display='block';
        document.getElementById('leyendo_1').style.visibility='hidden';
        document.getElementById('leyendo_1').style.display='none';
        document.getElementById('leyendo_2').hidden=false;        
      }
      

      function getAdditionalProcurementCategories(){
        var parametro = $("#disabledSelect_2").val();
        var year = $("#yearAdditionalProcurementCategories").val();
        
        if (parametro === null){
          alert('Selecciona al menos un destino de contratación');
          return;
          } else {
              $.ajax({
                  url: `${uri}:${port}${endPointAdditionalProcurementCategories}${parametro}/${year}`,
                  type: 'GET',
                  success: function(data){ 
                  $("#additionalProcurementCategoriesRes").val('');
                    $("#additionalProcurementCategoriesRes").val(JSON.stringify(data, null, 4));
                    $("#codeadditionalprocurementcategories").text(200);
                    $("#desadditionalprocurementcategories").text(`Success`);
                    document.getElementById('leyendo_4').hidden=true;
                    document.getElementById('clean_2').hidden=false;
                  },
                  error: function(data) {
                    $("#additionalProcurementCategoriesRes").val('Not Found');
                    $("#codeadditionalprocurementcategories").text(404);
                    $("#desadditionalprocurementcategories").text(`Not Found`);
                    document.getElementById('leyendo_4').hidden=true;
                    document.getElementById('clean_2').hidden=false;
                  }
              });
            }
        document.getElementById('leyendo_4').style.visibility='visible';
        document.getElementById('leyendo_4').style.display='block';
        document.getElementById('leyendo_3').style.visibility='hidden';
        document.getElementById('leyendo_3').style.display='none';
        document.getElementById('leyendo_4').hidden=false; 
      }
      

      function getContractingProcess(){
        var year = $("#yearContractingProcess​").val();
        $.ajax({
              url: `${uri}:${port}${endPointContractingProcess}${year}`,
              type: 'GET',
              success: function(data){ 
                $("#contractingprocessRes").val('');
                $("#contractingprocessRes").val(JSON.stringify(data, null, 4));
                $("#codecontractingprocess").text(200);
                $("#descontractingprocess").text(`Success`);
                document.getElementById('leyendo_6').hidden=true;
                document.getElementById('clean_3').hidden=false;
              },
              error: function(data) {
                $("#contractingprocessRes").val('Not Found');
                $("#codecontractingprocess").text(404);
                $("#descontractingprocess").text(`Not Found`);
                document.getElementById('leyendo_6').hidden=true;
                document.getElementById('clean_3').hidden=false;
              }
          });

        document.getElementById('leyendo_6').style.visibility='visible';
        document.getElementById('leyendo_6').style.display='block';
        document.getElementById('leyendo_5').style.visibility='hidden';
        document.getElementById('leyendo_5').style.display='none';
        document.getElementById('leyendo_6').hidden=false;
      }

      function getRecordPackages(){
        var year = $("#yearRecordPackage").val();
        $.ajax({
              url: `${uri}:${port}${endPointRecordPackages}${year}`,
              type: 'GET',
              success: function(data){ 
                $("#recordPackagesRes").val('');
                $("#recordPackagesRes").val(JSON.stringify(data, null, 4));
                $("#coderecordpackages").text(200);
                $("#desrecordpackages").text(`Success`);
                document.getElementById('leyendo_7').hidden=true;
                document.getElementById('clean_6').hidden=false;
              },
              error: function(data) {
                $("#recordPackagesRes").val('Not Found');
                $("#coderecordpackages").text(404);
                $("#desrecordpackages").text(`Not Found`);
                document.getElementById('leyendo_7').hidden=true;
                document.getElementById('clean_6').hidden=false;
              }
          });

        document.getElementById('leyendo_7').style.visibility='visible';
        document.getElementById('leyendo_7').style.display='block';
        document.getElementById('leyendo_8').style.visibility='hidden';
        document.getElementById('leyendo_8').style.display='none';
        document.getElementById('leyendo_7').hidden=false;
      }
      
      
      function downloadJSON(endpoint){
        switch (endpoint) {
          case 'procurementmethod':
            var parametro = $("#disabledSelect").val();
            var year = $("#yearProcurementMethod").val();
            document.getElementById('downley').hidden=false;
            document.getElementById('downlo').hidden=true;
            var uri_endpoint = `${uri}:${port}${endPointProcurementMethod}${parametro}/${year}`;
            break;
          case 'additionalprocurementcategories':
            var parametro = $("#disabledSelect_2").val();
            var year = $("#yearAdditionalProcurementCategories").val();
            document.getElementById('downley_2').hidden=false;
            document.getElementById('downlo_2').hidden=true;
            var uri_endpoint = `${uri}:${port}${endPointAdditionalProcurementCategories}${parametro}/${year}`;
            break;
          case 'contractingprocess':
            var year = $("#yearContractingProcess​").val();
            document.getElementById('downley_3').hidden=false;
            document.getElementById('downlo_3').hidden=true;
            var uri_endpoint = `${uri}:${port}${endPointContractingProcess}${year}`;
            break;
          case 'recordPackagesRes':
            var year = $("#yearRecordPackage").val();
            document.getElementById('downley_4').hidden=false;
            document.getElementById('downlo_10').hidden=true;
            var uri_endpoint = `${uri}:${port}${endPointRecordPackages}${year}`;
            break;
          default:
            break;
        }
        $.get(uri_endpoint).done(function (data) {
            var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent((JSON.stringify(data,null,4)));
            var dlAnchorElem = document.getElementById('downloadAnchorElem');
            dlAnchorElem.setAttribute("href",dataStr);
            dlAnchorElem.setAttribute("download", `${uri_endpoint}.json`);
            dlAnchorElem.click();
            document.getElementById('downley').hidden=true;
            document.getElementById('downlo').hidden=false;
            document.getElementById('downley_2').hidden=true;
            document.getElementById('downlo_2').hidden=false;
            document.getElementById('downley_3').hidden=true;
            document.getElementById('downlo_3').hidden=false;
            document.getElementById('downley_4').hidden=true;
            document.getElementById('downlo_10').hidden=false;
        });
      }
      function downloadCSV(endpoint){
        switch (endpoint) {
          case 'procurementmethod':
            var parametro = $("#disabledSelect").val();
            var year = $("#yearProcurementMethod").val();            
            var uri_endpoint = `${uri}:${port}${endPointProcurementMethod}csv/${parametro}/${year}`;
            document.getElementById('downley').hidden=false;
            document.getElementById('downlo_6').hidden=true;
            break;
          case 'additionalprocurementcategories':
            var parametro = $("#disabledSelect_2").val();
            var year = $("#yearAdditionalProcurementCategories").val();  
            var uri_endpoint = `${uri}:${port}${endPointAdditionalProcurementCategories}csv/${parametro}/${year}`;
            document.getElementById('downley_2').hidden=false;
            document.getElementById('downlo_5').hidden=true;
            break;
          case 'contractingprocess':
          var year = $("#yearContractingProcess​").val();
            var uri_endpoint = `${uri}:${port}${endPointContractingProcess}csv/${year}`;
            document.getElementById('downley_3').hidden=false;
            document.getElementById('downlo_4').hidden=true;
            break;
          default:
            break;
        }
        $.ajax({
              url: uri_endpoint,
              type: 'GET',
              success: function(info){ 
                generateCSV(info)
              },
              error: function(info) {
                alert(`Not Found`)
                document.getElementById('downley').hidden=true;
                document.getElementById('downlo').hidden=false;
                document.getElementById('downley_2').hidden=true;
                document.getElementById('downlo_2').hidden=false;
                document.getElementById('downley_3').hidden=true;
                document.getElementById('downlo_3').hidden=false;
                document.getElementById('downlo_4').hidden=false;
                document.getElementById('downlo_5').hidden=false;
                document.getElementById('downlo_6').hidden=false;
              }
          });
      }
      function downloadXLS(endpoint){
        switch (endpoint) {
          case 'procurementmethod':
            var parametro = $("#disabledSelect").val();
            var year = $("#yearProcurementMethod").val();            
            var uri_endpoint = `${uri}:${port}${endPointProcurementMethod}${parametro}/${year}`;
            document.getElementById('downley').hidden=false;
            document.getElementById('downlo_7').hidden=true;
            $.ajax({
              url: `${uri_endpoint}`,
              type: 'GET',
              success: function(data){ 
                var obj = generateData(data);
                generateExcel(obj);
                document.getElementById('downley').hidden=true;
                document.getElementById('downlo_7').hidden=false;
              },
              error: function(data) {
                $("#contractingprocessRes").val('Not Found');
                $("#codecontractingprocess").text(404);
                $("#descontractingprocess").text(`Not Found`);
                document.getElementById('downley').hidden=true;
                document.getElementById('downlo_7').hidden=false;
                alert(`Not Found`)
              }
            });
            break;
          case 'additionalprocurementcategories':
            var parametro = $("#disabledSelect_2").val();
            var year = $("#yearAdditionalProcurementCategories").val();  
            var uri_endpoint = `${uri}:${port}${endPointAdditionalProcurementCategories}${parametro}/${year}`;
            document.getElementById('downley_2').hidden=false;
            document.getElementById('downlo_8').hidden=true;
            $.ajax({
              url: `${uri_endpoint}`,
              type: 'GET',
              success: function(data){ 
                var obj = generateData(data);
                generateExcel(obj);
                document.getElementById('downley_2').hidden=true;
                document.getElementById('downlo_8').hidden=false;
              },
              error: function(data) {
                $("#contractingprocessRes").val('Not Found');
                $("#codecontractingprocess").text(404);
                $("#descontractingprocess").text(`Not Found`);
                document.getElementById('downley_2').hidden=true;
                document.getElementById('downlo_8').hidden=false;
                alert(`Not Found`)
              }
            });
            break;
          case 'contractingprocess':
            var year = $("#yearContractingProcess​").val();
            var uri_endpoint = `${uri}:${port}${endPointContractingProcess}${year}`;
            document.getElementById('downley_3').hidden=false;
            document.getElementById('downlo_9').hidden=true;
            $.ajax({
              url: `${uri_endpoint}`,
              type: 'GET',
              success: function(data){ 
                var obj = generateData(data);
                generateExcel(obj);
                document.getElementById('downley_3').hidden=true;
                document.getElementById('downlo_9').hidden=false;
              },
              error: function(data) {
                $("#contractingprocessRes").val('Not Found');
                $("#codecontractingprocess").text(404);
                $("#descontractingprocess").text(`Not Found`);
                document.getElementById('downley_3').hidden=true;
                document.getElementById('downlo_9').hidden=false;
                alert(`Not Found`)
              }
            });
            break;
          default:
            break;
        }
      }
      function copyResult(idTextArea){
        var textarea = document.getElementById(idTextArea);
        textarea.select(); 
        var successful = document.execCommand('copy');
        if(successful) alert('Copiado');
      }
      function generateData(data){
        var consecutivo = 1;
        var arrayIndice = new Array(
          {
            Path : 'ReleasePackage',
            Code : '1000'
          },
          {
            Path : 'Extensions',
            Code : '1100'
          },
          {
            Path : 'Publisher',
            Code : '1200'
          },
          {
            Path : 'Release',
            Code : '1300'
          },
          {
            Path : 'Parties',
            Code : '2000'
          },
          {
            Path : 'PartiesMemberOf',
            Code : '2100'
          },
          {
            Path : 'PartiesAdditionalContactPoint',
            Code : '2200'
          },
          {
            Path : 'Planning',
            Code : '3000'
          },
          {
            Path : 'PlanningRequestingUnits',
            Code : '3100'
          },
          {
            Path : 'PlanningContractingUnits',
            Code : '3200'
          },
          {
            Path : 'PlanningResponsibleUnits',
            Code : '3300'
          },
          {
            Path : 'ReleasePlanningBudgetBreakdown',
            Code : '3400'
          },
          {
            Path : 'BudgetLinesComponent',
            Code : '3500'
          },
          {
            Path : 'BudgetLinesMeasure',
            Code : '3600'
          },
          {
            Path : 'PlanningDocuments',
            Code : '3700'
          },
          {
            Path : 'RequestsForQuotes',
            Code : '3800'
          },
          {
            Path : 'RequestsForQuotesÍtems',
            Code : '3900'
          },
          {
            Path : 'RequestsForQuotesinvitedSuppliers',
            Code : '4000'
          },
          {
            Path : 'RequestsForQuotesQuotes',
            Code : '4100'
          },
          {
            Path : 'RequestsForQuotesQuotesItems',
            Code : '4200'
          },
          {
            Path : 'Tender',
            Code : '5000'
          },
          {
            Path : 'Tenderers',
            Code : '5100'
          },
          {
            Path : 'TenderItems',
            Code : '5200'
          },
          {
            Path : 'TenderDocuments',
            Code : '5300'
          },
          {
            Path : 'TendeMilestones',
            Code : '5400'
          },
          {
            Path : 'TenderAmendments',
            Code : '5500'
          },
          {
            Path : 'TenderClarificationMeetings',
            Code : '5600'
          },
          {
            Path : 'TenderClarificationMeetingsAttendees',
            Code : '5700'
          },
          {
            Path : 'buyer',
            Code : '5800'
          },
          {
            Path : 'TenderClarificationMeetingsOfficials',
            Code : '5900'
          },
          {
            Path : 'Awards',
            Code : '6000'
          },
          {
            Path : 'Suppliers',
            Code : '6100'
          },
          {
            Path : 'AwardsDocuments',
            Code : '6200'
          },
          {
            Path : 'AwardsAmendments',
            Code : '6300'
          },
          {
            Path : 'Contracts',
            Code : '7000'
          },
          {
            Path : 'ContractsItems',
            Code : '7100'
          },
          {
            Path : 'ContractsDocuments',
            Code : '7200'
          },
          {
            Path : 'ContractsAmendments',
            Code : '7300'
          },
          {
            Path : 'ContractsGuarantees',
            Code : '7400'
          },
          {
            Path : 'Implementation',
            Code : '8000'
          },
          {
            Path : 'ImplementationTransactions',
            Code : '8100'
          },
          {
            Path : 'ImplementationMilestones',
            Code : '8200'
          },
          {
            Path : 'ImplementationDocuments',
            Code : '8300'
          },
          {
            Path : 'RelatedProcesses',
            Code : '9000'
          }
        );
        var arrayReleasePackage = new Array();
        var arrayExtensions2 = new Array();
        var arrayPublishers = new Array();
        var arrayReleases = new Array();
        var arrayParties = new Array();
        var arrayMember = new Array();
        var arrayAdditionalContactPoint = new Array();
        var arrayPlanning = new Array();
        var arrayRequestingUnit = new Array();
        var arrayContractingUnit = new Array();
        var arrayResponsibleUnit = new Array();
        var arrayBudget = new Array();
        var arrayBudgetLinesComponent = new Array();
        var arrayBudgetLinesMeasure = new Array();
        var arrayPlanningDocuments = new Array();
        var arrayRequestsForQuotes = new Array();
        var arrayRequestsForQuotesItems = new Array();
        var arrayRequestsForQuotesinvitedSuppliers = new Array();
        var arrayRequestsForQuotesQuotes = new Array();
        var arrayRequestsForQuotesQuotesItems = new Array();
        var arrayTender = new Array();
        var arrayContractsItems = new Array();
        var arrayTenderes = new Array();
        var arrayTenderItems = new Array();
        var arrayTenderDocuments = new Array();
        var arrayTenderMilestones = new Array();
        var arrayTenderAmendment = new Array();
        var arrayTenderClarificationMeeting = new Array();
        var arrayBuyer = new Array();
        var arrayTenderClarificationMeetingAttendees = new Array();
        var arrayTenderClarificationMeetingOfficials = new Array();
        var arrayAwars = new Array();
        var arrayAwarsSuppliers = new Array();
        var arrayAwarsDocuments = new Array();
        var arrayAwarsAmendments = new Array();
        var arrayContracts = new Array();
        var arrayContractsdocuments = new Array();
        var arrayContractsAmendments = new Array();
        var arrayContractsGuarantees = new Array();
        var arrayContractsImplementation = new Array();
        var arrayContractsImplementationTrans = new Array();
        var arrayContractsImplementationMilestone = new Array();
        var arrayContractsImplementationDocuments = new Array();
        var arrayRelatedProcesses = new Array();
        var objResult = new Object();

        data.arrayReleasePackage.forEach(element => {
          var objReleasePackage = new Object({
            ocid: element.releases[0].ocid,
            uri: element.uri,
            version: element.version,
            publishedDate: element.publishedDate,
            license: element.license,
            publicationPolicy: element.publicationPolicy,
          });
          arrayReleasePackage.push(objReleasePackage);
          var arrayExtensions = new Array();
          element.extensions.forEach(extension => {
            arrayExtensions.push(extension)
          });
          var objExtension = new Object({
              ocid: element.releases[0].ocid,
              extensions : (arrayExtensions <= 0 ? '' : arrayExtensions.toString())
            });
          arrayExtensions2.push(objExtension)
          if(element.publisher !== undefined){
            var objPublisher = new Object({
              ocid: element.releases[0].ocid,
              'publisher/name': element.publisher.name,
              'publisher/scheme': element.publisher.scheme,
              'publisher/uid': element.publisher.uid,
              'publisher/uri': element.publisher.uri
            });
            arrayPublishers.push(objPublisher)
          }
          if(element.releases.length > 0){
            element.releases.forEach(release => {
              var objRelease = new Object({
                ocid: release.ocid,
                id: release.id,
                date: release.date,
                initiationType: release.initiationType,
                language: release.language,
                tag: release.tag[0]
              });
              arrayReleases.push(objRelease)
              //PARTIES
              if(release.parties.length > 0){
                release.parties.forEach(partie => {
                  //ROLES
                  var arrayRoles = new Array();
                  if(partie.roles !== undefined){
                    if(partie.roles.length > 0){
                      partie.roles.forEach(rol => {
                        arrayRoles.push(rol)
                      });
                    }
                  }
                  var objPartie = new Object({
                    ocid: release.ocid,
                    'parties/name': (partie.name === undefined ? '' : partie.name),
                    'parties/id': (partie.id === undefined ? '' : partie.id),
                    'parties/position': (partie.position === undefined ? '' : partie.position),
                    'parties/identifier/scheme': (partie.identifier === undefined ? '' : (partie.identifier.scheme === undefined ? '' : partie.identifier.scheme)),
                    'parties/identifier/id': (partie.identifier === undefined ? '' : (partie.identifier.id === undefined ? '' : partie.identifier.id)),
                    'parties/identifier/legalName': (partie.identifier === undefined ? '' : (partie.identifier.legalName === undefined ? '' : partie.identifier.legalName)),
                    'parties/identifier/legalPersonality': (partie.identifier === undefined ? '' : (partie.identifier.legalPersonality === undefined ? '' : partie.identifier.legalPersonality)),
                    'parties/identifier/givenName': (partie.identifier === undefined ? '' : (partie.identifier.givenName === undefined ? '' : partie.identifier.givenName)),
                    'parties/identifier/patronymicName': (partie.identifier === undefined ? '' : (partie.identifier.patronymicName === undefined ? '' : partie.identifier.patronymicName)),
                    'parties/identifier/matronymicName': (partie.identifier === undefined ? '' : (partie.identifier.matronymicName === undefined ? '' : partie.identifier.matronymicName)),
                    'parties/address/streetAddress': (partie.address === undefined ? '' : (partie.address.streetAddress === undefined ? '' : partie.address.streetAddress)),
                    'parties/address/locality': (partie.address === undefined ? '' : (partie.address.locality === undefined ? '' : partie.address.locality)),
                    'parties/address/region': (partie.address === undefined ? '' : (partie.address.region === undefined ? '' : partie.address.region)),
                    'parties/address/postalCode': (partie.address === undefined ? '' : (partie.address.postalCode === undefined ? '' : partie.address.postalCode)),
                    'parties/address/countryName': (partie.address === undefined ? '' : (partie.address.countryName === undefined ? '' : partie.address.countryName)),
                    'parties/contactPoint/name': (partie.contactPoint === undefined ? '' : (partie.contactPoint.name === undefined ? '' : partie.contactPoint.name)),
                    'parties/contactPoint/email': (partie.contactPoint === undefined ? '' : (partie.contactPoint.email === undefined ? '' : partie.contactPoint.email)),
                    'parties/contactPoint/telephone': (partie.contactPoint === undefined ? '' : (partie.contactPoint.telephone === undefined ? '' : partie.contactPoint.telephone)),
                    'parties/contactPoint/faxNumber': (partie.contactPoint === undefined ? '' : (partie.contactPoint.faxNumber === undefined ? '' : partie.contactPoint.faxNumber)),
                    'parties/contactPoint/url': (partie.contactPoint === undefined ? '' : (partie.contactPoint.url === undefined ? '' : partie.contactPoint.url)),
                    'parties/contactPoint/type': (partie.contactPoint === undefined ? '' : (partie.contactPoint.type === undefined ? '' : partie.contactPoint.type)),
                    'parties/contactPoint/givenName': (partie.contactPoint === undefined ? '' : (partie.contactPoint.givenName === undefined ? '' : partie.contactPoint.givenName)),
                    'parties/contactPoint/patronymicName': (partie.contactPoint === undefined ? '' : (partie.contactPoint.patronymicName === undefined ? '' : partie.contactPoint.patronymicName)),
                    'parties/contactPoint/matronymicName': (partie.contactPoint === undefined ? '' : (partie.contactPoint.matronymicName === undefined ? '' : partie.contactPoint.matronymicName)),
                    'parties/roles': (arrayRoles <= 0 ? '' : arrayRoles.toString()),
                  });
                  arrayParties.push(objPartie)
                  //MEMBER OF
                  if(partie.memberOf !== undefined){
                    if(partie.memberOf.length > 0){
                      partie.memberOf.forEach(member => {
                        var objMember = new Object({
                          ocid : release.ocid,
                          'parties/id' : (partie.id === undefined ? '' : partie.id),
                          'parties/memberOf/id' : (member.id === undefined ? '' : member.id),
                          'parties/memberOf/name' : (member.name === undefined ? '' : member.name)
                        });
                        arrayMember.push(objMember)
                      });
                    }
                  }
                  
                  //additionalContactPoints
                  if(partie.additionalContactPoints !== undefined){
                    if(partie.additionalContactPoints.length > 0){
                      partie.additionalContactPoints.forEach(additionalContactPoint => {
                        //availableLanguage
                        var arrayAvailableLanguage = new Array();
                        if(additionalContactPoint.availableLanguage !== undefined){
                          if(additionalContactPoint.availableLanguage.length > 0){
                            additionalContactPoint.availableLanguage.forEach(availableLanguage => {
                              arrayAvailableLanguage.push(availableLanguage)
                            });
                          }
                        }
                        var objAdditionalContactPoint = new Object({
                          ocid : release.ocid,
                          'parties/id': partie.id,
                          'parties/additionalContacPoints/contactPointType' : (additionalContactPoint.type === undefined ? '' : additionalContactPoint.type),
                          'parties/additionalContacPoints/name' : (additionalContactPoint.name === undefined ? '' : additionalContactPoint.name),
                          'parties/additionalContacPoints/givenName' : (additionalContactPoint.givenName === undefined ? '' : additionalContactPoint.givenName),
                          'parties/additionalContacPoints/patronymicName' : (additionalContactPoint.patronymicName === undefined ? '' : additionalContactPoint.patronymicName),
                          'parties/additionalContacPoints/matronymicName' : (additionalContactPoint.matronymicName === undefined ? '' : additionalContactPoint.matronymicName),
                          'parties/additionalContacPoints/email' : (additionalContactPoint.email === undefined ? '' : additionalContactPoint.email),
                          'parties/additionalContacPoints/telephone' : (additionalContactPoint.telephone === undefined ? '' : additionalContactPoint.telephone),
                          'parties/additionalContacPoints/faxNumber' : (additionalContactPoint.faxNumber === undefined ? '' : additionalContactPoint.faxNumber),
                          'parties/additionalContacPoints/url' : (additionalContactPoint.url === undefined ? '' : additionalContactPoint.url),
                          'parties/additionalContacPoints/availableLanguage': (arrayAvailableLanguage <= 0 ? '' : arrayAvailableLanguage.toString()),
                        });
                        arrayAdditionalContactPoint.push(objAdditionalContactPoint)
                      });
                    }
                  }
                });
              }
            //PLANNING
            if(release.planning !== undefined){
              var objPlanning = new Object({
                ocid: release.ocid,
                rationale: (release.planning.rationale === undefined ? '' : release.planning.rationale),
                hasquotes: (release.planning.hasquotes === undefined ? '' : (release.planning.hasquotes == true ? 'true' : 'false'))
              });
              arrayPlanning.push(objPlanning)
              //requestingUnits
              if(release.planning.requestingUnits !== undefined){
                if(release.planning.requestingUnits.length > 0){
                  release.planning.requestingUnits.forEach(requestingUnit => {
                    var objRequestingUnit = new Object({
                      ocid: release.ocid,
                      'planning/requestingUnits/id' : (requestingUnit.id === undefined ? '' : requestingUnit.id),
                      'planning/requestingUnits/name' : (requestingUnit.name === undefined ? '' : requestingUnit.name)
                    });
                    arrayRequestingUnit.push(objRequestingUnit)  
                  });
                }
              }
              //contractingUnits
              if(release.planning.contractingUnits !== undefined){
                if(release.planning.contractingUnits.length > 0){
                  release.planning.contractingUnits.forEach(contractingUnit => {
                    var objContractingUnit = new Object({
                      ocid: release.ocid,
                      'planning/contractingUnits/id' : (contractingUnit.id === undefined ? '' : contractingUnit.id),
                      'planning/contractingUnits/name' : (contractingUnit.name === undefined ? '' : contractingUnit.name)
                    });
                    arrayContractingUnit.push(objContractingUnit)  
                  });
                }
              }
              //responsibleUnits
              if(release.planning.responsibleUnits !== undefined){
                if(release.planning.responsibleUnits.length > 0){
                  release.planning.responsibleUnits.forEach(responsibleUnit => {
                    var objResponsibleUnit = new Object({
                      ocid: release.ocid,
                      'planning/responsibleUnits/id' : (responsibleUnit.id === undefined ? '' : responsibleUnit.id),
                      'planning/responsibleUnits/name' : (responsibleUnit.name === undefined ? '' : responsibleUnit.name)
                    });
                    arrayResponsibleUnit.push(objResponsibleUnit)  
                  });
                }
              }
              //budget
              if(release.planning.budget !== undefined){
                if(release.planning.budget.budgetBreakdown !== undefined){
                  if(release.planning.budget.budgetBreakdown.length > 0){
                    release.planning.budget.budgetBreakdown.forEach(budgetBreakdown => {
                      var objBudgetBreakdown = new Object({
                        ocid: release.ocid,
                        'planning/budget/budgetBreakdown/id' : (budgetBreakdown.id === undefined ? '' : budgetBreakdown.id),
                        'planning/budget/budgetBreakdown/description' : (budgetBreakdown.description === undefined ? '' : budgetBreakdown.description),
                        'planning/budget/budgetBreakdown/origin' : (budgetBreakdown.origin === undefined ? '' : budgetBreakdown.origin),
                        'planning/budget/budgetBreakdown/fundType' : (budgetBreakdown.fundType === undefined ? '' : budgetBreakdown.fundType),
                        'planning/budget/budgetBreakdown/period/startDate' : (budgetBreakdown.period === undefined ? '' : (budgetBreakdown.period.startDate === undefined ? '' : budgetBreakdown.period.startDate)),
                        'planning/budget/budgetBreakdown/period/endDate' : (budgetBreakdown.period === undefined ? '' : (budgetBreakdown.period.endDate === undefined ? '' : budgetBreakdown.period.endDate)),
                        'planning/budget/budgetBreakdown/value/amount' : (budgetBreakdown.amount === undefined ? '' : (budgetBreakdown.amount.amount === undefined ? '' : budgetBreakdown.amount.amount)),
                        'planning/budget/budgetBreakdown/value/currency' : (budgetBreakdown.amount === undefined ? '' : (budgetBreakdown.amount.currency === undefined ? '' : budgetBreakdown.amount.currency)),
                        'planning/budget/budgetBreakdown/sourceParty/name' : (budgetBreakdown.sourceParty === undefined ? '' : (budgetBreakdown.sourceParty.name === undefined ? '' : budgetBreakdown.sourceParty.name)),
                        'planning/budget/budgetBreakdown/sourceParty/id' : (budgetBreakdown.sourceParty === undefined ? '' : (budgetBreakdown.sourceParty.id === undefined ? '' : budgetBreakdown.sourceParty.id)),
                      });
                      arrayBudget.push(objBudgetBreakdown)
                      if(budgetBreakdown.budgetLines !== undefined){
                        if(budgetBreakdown.budgetLines.length > 0){
                          budgetBreakdown.budgetLines.forEach(budgetLine => {
                            if(budgetLine.components !== undefined){
                              if(budgetLine.components.length > 0){
                                budgetLine.components.forEach(component => {
                                  var objBudgetLinesComponent = new Object({
                                    ocid: release.ocid,
                                    'planning/budget/budgetBreakdown/budgetLines/components/name' : (component.name === undefined ? '' : component.name),
                                    'planning/budget/budgetBreakdown/budgetLines/components/level' : (component.level === undefined ? '' : component.level),
                                    'planning/budget/budgetBreakdown/budgetLines/components/code' : (component.code === undefined ? '' : component.code),
                                    'planning/budget/budgetBreakdown/budgetLines/components/description': (component.description === undefined ? '' : component.description)
                                  });
                                  arrayBudgetLinesComponent.push(objBudgetLinesComponent)
                                });
                              }
                            }
                            if(budgetLine.measures !== undefined){
                              if(budgetLine.measures.length > 0){
                                budgetLine.measures.forEach(measure => {
                                  var objBudgetLinesMeasure = new Object({
                                    ocid: release.ocid,
                                    'planning/budget/budgetBreakdown/budgetLines/measures/id' : (measure.id === undefined ? '' : measure.id),
                                    'planning/budget/budgetBreakdown/budgetLines/measures/update' : (measure.update === undefined ? '' : measure.update),
                                    'planning/budget/budgetBreakdown/budgetLines/measures/amount' : (measure.value === undefined ? '' : (measure.value.amount === undefined ? '' : measure.value.amount)),
                                    'planning/budget/budgetBreakdown/budgetLines/measures/currency' : (measure.value === undefined ? '' : (measure.value.currency === undefined ? '' : measure.value.currency)),
                                  });
                                  arrayBudgetLinesMeasure.push(objBudgetLinesMeasure)
                                });
                              }
                            }
                          });   
                        }
                      }
                    });
                  }
                }
              }
              if(release.planning.documents !== undefined){
                if(release.planning.documents.length > 0){
                  release.planning.documents.forEach(document => {
                    var objDocument = new Object({
                      ocid: release.ocid,
                      'planning/documents/id' : (document.id === undefined ? '' : document.id),
                      'planning/documents/documentType' : (document.documentType === undefined ? '' : document.documentType),
                      'planning/documents/title' : (document.title === undefined ? '' : document.title),
                      'planning/documents/description' : (document.description === undefined ? '' : document.description),
                      'planning/documents/url' : (document.url === undefined ? '' : document.url),
                      'planning/documents/datePublished' : (document.datePublished === undefined ? '' : document.datePublished),
                      'planning/documents/dateModified' : (document.dateModified === undefined ? '' : document.dateModified),
                      'planning/documents/format' : (document.format === undefined ? '' : document.format),
                      'planning/documents/language' : (document.language === undefined ? '' : document.language)
                    });
                    arrayPlanningDocuments.push(objDocument);
                  });
                }
              }
              if(release.planning.requestsForQuotes !== undefined){
                if(release.planning.requestsForQuotes.length > 0){
                  release.planning.requestsForQuotes.forEach(requestForQuote => {
                    var objRequestForQuote = new Object({
                      ocid: release.ocid,
                      'planning/requestsForQuotes/id' : (requestForQuote.id === undefined ? '' : requestForQuote.id),
                      'planning/requestsForQuotes/title' : (requestForQuote.title === undefined ? '' : requestForQuote.title),
                      'planning/requestsForQuotes/description' : (requestForQuote.description === undefined ? '' : requestForQuote.description),
                      'planning/requestsForQuotes/period/startDate' : (requestForQuote.period === undefined ? '' : (requestForQuote.period.startDate === undefined ? '' : requestForQuote.period.startDate)),
                      'planning/requestsForQuotes/period/endDate' : (requestForQuote.period === undefined ? '' : (requestForQuote.period.endDate === undefined ? '' : requestForQuote.period.endDate))
                    });
                    arrayRequestsForQuotes.push(objRequestForQuote);
                    if(requestForQuote.items !== undefined){
                      if(requestForQuote.items.length > 0){
                        requestForQuote.items.forEach(item => {
                          var objItem = new Object({
                            ocid: release.ocid,
                            'planning/requestsForQuotes/id' : (requestForQuote.id === undefined ? '' : requestForQuote.id),
                            'planning/requestsForQuotes/items/id' : (item.id === undefined ? '' : item.id),
                            'planning/requestsForQuotes/items/description' : (item.description === undefined ? '' : item.description),
                            'planning/requestsForQuotes/items/quantity' : (item.quantity === undefined ? '' : item.quantity),
                            'planning/requestsForQuotes/items/classification/id' : (item.classification === undefined ? '' : (item.classification.id === undefined ? '' : item.classification.id)),
                            'planning/requestsForQuotes/items/classification/description' : (item.classification === undefined ? '' : (item.classification.description === undefined ? '' : item.classification.description)),
                            'planning/requestsForQuotes/items/unit/name' : (item.unit === undefined ? '' : item.unit.name)
                          });
                          arrayRequestsForQuotesItems.push(objItem);
                        });
                      }
                    }
                    if(requestForQuote.invitedSuppliers !== undefined){
                      if(requestForQuote.invitedSuppliers.length > 0){
                        requestForQuote.invitedSuppliers.forEach(invitedSupplier => {
                          var objInvitedSupplier = new Object({
                            ocid: release.ocid,
                            'planning/requestsForQuotes/id' : (requestForQuote.id === undefined ? '' : requestForQuote.id),
                            'planning/invitedSuppliers/name' : (invitedSupplier.name === undefined ? '' : invitedSupplier.name),
                            'planning/invitedSuppliers/id' : (invitedSupplier.id === undefined ? '' : invitedSupplier.id)
                          });
                          arrayRequestsForQuotesinvitedSuppliers.push(objInvitedSupplier);
                        });
                      }
                    }
                    if(requestForQuote.quotes !== undefined){
                      if(requestForQuote.quotes.length > 0){
                        requestForQuote.quotes.forEach(quote => {
                          var objRequestsForQuotesQuotes = new Object({
                            ocid: release.ocid,
                            'planning/requestsForQuotes/id' : (requestForQuote.id === undefined ? '' : requestForQuote.id),
                            'planning/requestsForQuotes/quotes/id' : (quote.id === undefined ? '' : quote.id),
                            'planning/requestsForQuotes/quotes/description' : (quote.description === undefined ? '' : quote.description),
                            'planning/requestsForQuotes/quotes/date' : (quote.date === undefined ? '' : quote.date),
                            'planning/requestsForQuotes/quotes/value/amount' : (quote.value === undefined ? '' : (quote.value.amount === undefined ? '' : quote.value.amount)),
                            'planning/requestsForQuotes/quotes/quotePeriod/startDate' : (quote.period === undefined ? '' : (quote.period.startDate === undefined ? '' : quote.period.startDate)),
                            'planning/requestsForQuotes/quotes/quotePeriod/endDate' : (quote.period === undefined ? '' : (quote.period.endDate === undefined ? '' : quote.period.endDate)),
                            'planning/requestsForQuotes/quotes/issuingSupplier/name' : (quote.issuingSupplier === undefined ? '' : (quote.issuingSupplier.name === undefined ? '' : quote.issuingSupplier.name)),
                            'planning/requestsForQuotes/quotes/issuingSupplier/id' : (quote.issuingSupplier === undefined ? '' : (quote.issuingSupplier.id === undefined ? '' : quote.issuingSupplier.id))
                          });
                          arrayRequestsForQuotesQuotes.push(objRequestsForQuotesQuotes);
                          if(quote.items !== undefined){
                            if(quote.items.length > 0){
                              quote.items.forEach(item => {
                                var objRequestsForQuotesQuotesItems = new Object({
                                  ocid: release.ocid,
                                  'planning/requestsForQuotes/id' : (requestForQuote.id === undefined ? '' : requestForQuote.id),
                                  'planning/requestsForQuotes/quotes/id' : (quote.id === undefined ? '' : quote.id),
                                  'planning/requestsForQuotes/quotes/items/id' : (item.id === undefined ? '' : item.id),
                                  'planning/requestsForQuotes/quotes/items/classification/id' : (item.classification === undefined ? '' : (item.classification.id === undefined ? '' : item.classification.id)),
                                  'planning/requestsForQuotes/quotes/items/classification/description' : (item.classification === undefined ? '' : (item.classification.description === undefined ? '' : item.classification.description)),
                                  'planning/requestsForQuotes/quotes/items/unit/name' : (item.unit === undefined ? '' : (item.unit.name === undefined ? '' : item.unit.name)),
                                  'planning/requestsForQuotes/quotes/items/unit/value/amount' : (item.unit === undefined ? '' : item.unit.value.amount),
                                  'planning/requestsForQuotes/quotes/issuingSupplier/name' : (quote.issuingSupplier === undefined ? '' : (quote.issuingSupplier.name === undefined ? '' : quote.issuingSupplier.name)),
                                  'planning/requestsForQuotes/quotes/issuingSupplier/id' : (quote.issuingSupplier === undefined ? '' : (quote.issuingSupplier.id === undefined ? '' : quote.issuingSupplier.id))
                                });
                                arrayRequestsForQuotesQuotesItems.push(objRequestsForQuotesQuotesItems);
                              });
                            }
                          }
                        });
                      }
                    }
                  });
                }
              }
            }
            if(release.tender !== undefined){
              //additionalProcurementCategories
              var arrayAdditionalProcurementCategories = new Array();
              if(release.tender.additionalProcurementCategories !== undefined){
                if(release.tender.additionalProcurementCategories.length > 0){
                  release.tender.additionalProcurementCategories.forEach(additionalProcurementCategory => {
                    arrayAdditionalProcurementCategories.push(additionalProcurementCategory)
                  });
                }
              }
              //submissionMethod
              var arraySubmissionMethod = new Array();
              if(release.tender.submissionMethod !== undefined){
                if(release.tender.submissionMethod.length > 0){
                  release.tender.submissionMethod.forEach(submissionMethod => {
                    arraySubmissionMethod.push(submissionMethod)
                  });
                }
              }
              var objTender = new Object({
                ocid: release.ocid,
                'tender/id': (release.tender.id === undefined ? '' : release.tender.id),
                'tender/title': (release.tender.title === undefined ? '' : release.tender.title),
                'tender/description': (release.tender.description === undefined ? '' : release.tender.description),
                'tender/status': (release.tender.status === undefined ? '' : release.tender.status),
                'tender/procuringEntity/name': (release.tender.procuringEntity === undefined ? '' : (release.tender.procuringEntity.name === undefined ? '' : release.tender.procuringEntity.name)),
                'tender/procuringEntity/id': (release.tender.procuringEntity === undefined ? '' : (release.tender.procuringEntity.id === undefined ? '' : release.tender.procuringEntity.id)),
                'tender/value/amount': (release.tender.value === undefined ? '' : (release.tender.value.amount === undefined ? '' : release.tender.value.amount)),
                'tender/value/currency': (release.tender.value === undefined ? '' : (release.tender.value.currency === undefined ? '' : release.tender.value.currency)),
                'tender/minValue/amount': (release.tender.minValue === undefined ? '' : (release.tender.minValue.amount === undefined ? '' : release.tender.minValue.amount)),
                'tender/minValue/currency': (release.tender.minValue === undefined ? '' : (release.tender.minValue.currency === undefined ? '' : release.tender.minValue.currency)),
                'tender/procurementMethod': (release.tender.procurementMethod === undefined ? '' : release.tender.procurementMethod),
                'tender/procurementMethodDetails': (release.tender.procurementMethodDetails === undefined ? '' : release.tender.procurementMethodDetails),
                'tender/procurementMethodRationale': (release.tender.procurementMethodRationale === undefined ? '' : release.tender.procurementMethodRationale),
                'tender/mainProcurementCategory': (release.tender.mainProcurementCategory === undefined ? '' : release.tender.mainProcurementCategory),
                'tender/additionalProcurementCategories': (arrayAdditionalProcurementCategories <= 0 ? '' : arrayAdditionalProcurementCategories.toString()),
                'tender/awardCriteria': (release.tender.awardCriteria === undefined ? '' : release.tender.awardCriteria),
                'tender/awardCriteriaDetails': (release.tender.awardCriteriaDetails === undefined ? '' : release.tender.awardCriteriaDetails),
                'tender/submissionMethod': (arraySubmissionMethod <= 0 ? '' : arraySubmissionMethod.toString()),
                'tender/submissionMethodDetails': (release.tender.submissionMethodDetails === undefined ? '' : release.tender.submissionMethodDetails),
                'tender/tenderPeriod/startDate': (release.tender.tenderPeriod === undefined ? '' : (release.tender.tenderPeriod.startDate === undefined ? '' : release.tender.tenderPeriod.startDate)),
                'tender/tenderPeriod/endDate': (release.tender.tenderPeriod === undefined ? '' : (release.tender.tenderPeriod.endDate === undefined ? '' : release.tender.tenderPeriod.endDate)),
                'tender/enquiryPeriod/startDate': (release.tender.enquiryPeriod === undefined ? '' : (release.tender.enquiryPeriod.startDate === undefined ? '' : release.tender.enquiryPeriod.startDate)),
                'tender/enquiryPeriod/endDate': (release.tender.enquiryPeriod === undefined ? '' : (release.tender.enquiryPeriod.endDate === undefined ? '' : release.tender.enquiryPeriod.endDate)),
                'tender/hasEnquiries': (release.tender.hasEnquiries === true ? 'true' : false),
                'tender/eligibilityCriteria': (release.tender.eligibilityCriteria === undefined ? '' : release.tender.eligibilityCriteria),
                'tender/awardPeriod/startDate': (release.tender.awardPeriod === undefined ? '' : (release.tender.awardPeriod.startDate === undefined ? '' : release.tender.awardPeriod.startDate)),
                'tender/awardPeriod/endDate': (release.tender.awardPeriod === undefined ? '' : (release.tender.awardPeriod.endDate === undefined ? '' : release.tender.awardPeriod.endDate)),
                'tender/numberOfTenderers': (release.tender.numberOfTenderers === undefined ? '' : release.tender.numberOfTenderers),
              });
              arrayTender.push(objTender)
            }
            if(release.tender !== undefined){
              if(release.tender.tenderers !== undefined){
                release.tender.tenderers.forEach(tender => {
                  var objTenderes = new Object({
                      ocid: release.ocid,
                      'tender/tenderers/name': tender.name,
                      'tender/tenderers/id': tender.id
                    });
                    arrayTenderes.push(objTenderes)
                });
              }
            }
            if(release.tender !== undefined){
              if(release.tender.items !== undefined){
                release.tender.items.forEach(item => {
                  var objTenderItem = new Object({
                      ocid: release.ocid,
                      'tender/items/id': (item.id === undefined ? '' : item.id),
                      'tender/items/description': (item.description === undefined ? '' : item.description),
                      'tender/items/classification/scheme': (item.classification === undefined ? '' : (item.classification.scheme === undefined ? '' : item.classification.scheme)),
                      'tender/items/classification/id': (item.classification === undefined ? '' : (item.classification.id === undefined ? '' : item.classification.id)),
                      'tender/items/classification/description': (item.classification === undefined ? '' : (item.classification.description === undefined ? '' : item.classification.description)),
                      'tender/items/quantity': (item.quantity === undefined ? '' : item.quantity),
                      'tender/items/unit/name': (item.unit === undefined ? '' : (item.unit.name === undefined ? '' : item.unit.name)),
                      'tender/items/unit/value/amount': (item.unit === undefined ? '' : (item.unit.value === undefined ? '' : (item.unit.value.amount === undefined ? '' : item.unit.value.amount))),
                      'tender/items/unit/value/netAmount': (item.unit === undefined ? '' : (item.unit.value === undefined ? '' : (item.unit.value.amount === undefined ? '' : item.unit.value.amount))),
                      'tender/items/unit/value/currency': (item.unit === undefined ? '' : (item.unit.value === undefined ? '' : (item.unit.value.currency === undefined ? '' : item.unit.value.currency))),
                      'tender/items/deliveryLocation/geometry/type': ((item.deliveryLocation !== undefined) ? (item.deliveryLocation.geometry !== undefined ? item.deliveryLocation.geometry.type : '') : ''),
                      'tender/items/deliveryLocation/geometry/coordinates': ((item.deliveryLocation !== undefined) ? (item.deliveryLocation.geometry !== undefined ? (item.deliveryLocation.geometry.coordinates !== undefined ? item.deliveryLocation.geometry.coordinates[0]+','+item.deliveryLocation.geometry.coordinates[1] : '') : '') : ''),
                      'tender/items/deliveryAddress/streetAddress': (item.deliveryAddress === undefined ? '' : (item.deliveryAddress.streetAddress === undefined ? '' : item.deliveryAddress.streetAddress)),
                      'tender/items/deliveryAddress/locality': (item.deliveryAddress === undefined ? '' : (item.deliveryAddress.locality === undefined ? '' : item.deliveryAddress.locality)),
                      'tender/items/deliveryAddress/postalCode': (item.deliveryAddress === undefined ? '' : (item.deliveryAddress.postalCode === undefined ? '' : item.deliveryAddress.postalCode)),
                      'tender/items/deliveryAddress/countryName': (item.deliveryAddress === undefined ? '' : (item.deliveryAddress.countryName === undefined ? '' : item.deliveryAddress.countryName))
                    });
                    arrayTenderItems.push(objTenderItem)
                });
              }
            }
            if(release.tender !== undefined){
              if(release.tender.documents !== undefined){
                release.tender.documents.forEach(document => {
                  var objTenderdocument = new Object({
                      ocid: release.ocid,
                      'tender/documents/id': (document.id === undefined ? '' : document.id),
                      'tender/documents/documentType': (document.documentType === undefined ? '' : document.documentType),
                      'tender/documents/title': (document.title === undefined ? '' : document.title),
                      'tender/documents/description': (document.description === undefined ? '' : document.description),
                      'tender/documents/url': (document.url === undefined ? '' : document.url),
                      'tender/documents/datePublished': (document.datePublished === undefined ? '' : document.datePublished),
                      'tender/documents/dateModified': (document.dateModified === undefined ? '' : document.dateModified),
                      'tender/documents/format': (document.format === undefined ? '' : document.format),
                      'tender/documents/language': (document.language === undefined ? '' : document.language)
                    });
                    arrayTenderDocuments.push(objTenderdocument)
                });
              }
            }
            if(release.tender !== undefined){
              if(release.tender.milestones !== undefined){
                release.tender.milestones.forEach(milestone => {
                  var objTendermilestone = new Object({
                      ocid: release.ocid,
                      'tender/milestones/id': (milestone.id === undefined ? '' : milestone.id),
                      'tender/milestones/title': (milestone.title === undefined ? '' : milestone.title),
                      'tender/milestones/type': (milestone.type === undefined ? '' : milestone.type),
                      'tender/milestones/description': (milestone.description === undefined ? '' : milestone.description),
                      'tender/milestones/dueDate': (milestone.dueDate === undefined ? '' : milestone.dueDate),
                      'tender/milestones/dateModified': (milestone.dateModified === undefined ? '' : milestone.dateModified),
                      'tender/milestones/status': (milestone.status === undefined ? '' : milestone.status)
                    });
                    arrayTenderMilestones.push(objTendermilestone)
                });
              }
            }
            if(release.tender !== undefined){
              if(release.tender.amendments !== undefined){
                release.tender.amendments.forEach(amendment => {
                  var objTenderAmendment = new Object({
                      ocid: release.ocid,
                      'tender/amendments/date': (amendment.date === undefined ? '' : amendment.date),
                      'tender/amendments/rationale': (amendment.rationale === undefined ? '' : amendment.rationale),
                      'tender/amendments/id': (amendment.id === undefined ? '' : amendment.id),
                      'tender/amendments/description': (amendment.description === undefined ? '' : amendment.description)
                    });
                    arrayTenderAmendment.push(objTenderAmendment)
                });
              }
            }
            if(release.tender !== undefined){
              if(release.tender.clarificationMeetings !== undefined){
                release.tender.clarificationMeetings.forEach(clarificationMeeting => {
                  var objTenderClarificationMeeting = new Object({
                      ocid: release.ocid,
                      'tender/clarificationMeetings/id': (clarificationMeeting.id === undefined ? '' : clarificationMeeting.id),
                      'tender/clarificationMeetings/date': (clarificationMeeting.date === undefined ? '' : clarificationMeeting.date)
                    });
                    arrayTenderClarificationMeeting.push(objTenderClarificationMeeting)
                    if(clarificationMeeting.attendees !== undefined){
                      clarificationMeeting.attendees.forEach(attendee => {
                        var objTenderAttendees = new Object({
                          ocid: release.ocid,
                          'tender/clarificationMeetings/id': (clarificationMeeting.id === undefined ? '' : clarificationMeeting.id),
                          'tender/clarificationMeetings/attendees/name': (attendee.name === undefined ? '' : attendee.name),
                          'tender/clarificationMeetings/attendees/id': (attendee.id === undefined ? '' : attendee.id)
                        });
                        arrayTenderClarificationMeetingAttendees.push(objTenderAttendees)
                      })
                    }
                    if(clarificationMeeting.officials !== undefined){
                      clarificationMeeting.officials.forEach(official => {
                        var objTenderOfficials = new Object({
                          ocid: release.ocid,
                          'tender/clarificationMeetings/id': (clarificationMeeting.id === undefined ? '' : clarificationMeeting.id),
                          'tender/clarificationMeetings/officials/name': (official.name === undefined ? '' : official.name),
                          'tender/clarificationMeetings/officials/id': (official.id === undefined ? '' : official.id)
                        });
                        arrayTenderClarificationMeetingOfficials.push(objTenderOfficials)
                      })
                    }
                });
              }
            }
            if(release.buyer !== undefined){
              var objReleaseBuyer = new Object({
                ocid: release.ocid,
                'buyer/name': (release.buyer.name === undefined ? '' : release.buyer.name),
                'buyer/id': (release.buyer.id === undefined ? '' : release.buyer.id)
              });
              arrayBuyer.push(objReleaseBuyer)
            }
            if(release.awards !== undefined){
              if(release.awards.length > 0){
                release.awards.forEach(award => {
                  var objReleaseAward = new Object({
                    ocid: release.ocid,
                    'awards/id': (award.id === undefined ? '' : award.id),
                    'awards/title': (award.title === undefined ? '' : award.title),
                    'awards/description': (award.description === undefined ? '' : award.description),
                    'awards/rationale': (award.rationale === undefined ? '' : award.rationale),
                    'awards/status': (award.status === undefined ? '' : award.status),
                    'awards/date': (award.date === undefined ? '' : award.date),
                    'awards/value/netAmount': ((award.value !== undefined) ? (award.value.amount !== undefined ? award.value.amount : '') : ''),
                    'awards/value/amount': ((award.value !== undefined) ? (award.value.amount !== undefined ? award.value.amount : '') : ''),
                    'awards/value/currency': ((award.value !== undefined) ? (award.value.currency !== undefined ? award.value.currency : '') : ''),
                    'awards/contractPeriod/startDate': ((award.contractPeriod !== undefined) ? (award.contractPeriod.startDate !== undefined ? award.contractPeriod.startDate : '') : ''),
                    'awards/contractPeriod/endDate': ((award.contractPeriod !== undefined) ? (award.contractPeriod.endDate !== undefined ? award.contractPeriod.endDate : '') : ''),
                  });
                  arrayAwars.push(objReleaseAward);
                  var objReleaseAward = new Object({
                    ocid: release.ocid,
                    'awards/id': (award.id === undefined ? '' : award.id),
                    'awards/suppliers/name': ((award.suppliers !== undefined) ? (award.suppliers[0].name !== undefined ? award.suppliers[0].name : '') : ''),
                    'awards/suppliers/id': ((award.suppliers !== undefined) ? (award.suppliers[0].id !== undefined ? award.suppliers[0].id : '') : ''),
                  })
                  arrayAwarsSuppliers.push(objReleaseAward)
                  if(award.documents !== undefined){
                    if(award.documents.length > 0){
                      award.documents.forEach(awardDocument => {
                        var objAwardDocument = new Object({
                          ocid: release.ocid,
                          'awards/documents/id': (awardDocument.id === undefined ? '' : awardDocument.id),
                          'awards/documents/documentType': (awardDocument.documentType === undefined ? '' : awardDocument.documentType),
                          'awards/documents/title': (awardDocument.title === undefined ? '' : awardDocument.title),
                          'awards/documents/description': (awardDocument.description === undefined ? '' : awardDocument.description),
                          'awards/documents/url': (awardDocument.url === undefined ? '' : awardDocument.url),
                          'awards/documents/datePublished': (awardDocument.datePublished === undefined ? '' : awardDocument.datePublished),
                          'awards/documents/dateModified': (awardDocument.dateModified === undefined ? '' : awardDocument.dateModified),
                          'awards/documents/format': (awardDocument.format === undefined ? '' : awardDocument.format),
                          'awards/documents/language': (awardDocument.language === undefined ? '' : awardDocument.language),
                        })
                        arrayAwarsDocuments.push(objAwardDocument);
                      })
                    }
                  }
                  if(award.amendments !== undefined){
                    if(award.amendments.length > 0){
                      award.amendments.forEach(amendment => {
                        var objAmendment = new Object({
                          ocid: release.ocid,
                          'awards/amendments/date': (amendment.date === undefined ? '' : amendment.date),
                          'awards/amendments/rationale': (amendment.rationale === undefined ? '' : amendment.rationale),
                          'awards/amendments/id': (amendment.id === undefined ? '' : amendment.id),
                          'awards/amendments/description': (amendment.description === undefined ? '' : amendment.description),
                          
                        })
                        arrayAwarsAmendments.push(objAmendment);
                      })
                    }
                  }
                });
              }
            }
            if(release.contracts !== undefined){
              if(release.contracts.length > 0){
                release.contracts.forEach(contract => {
                  var objContract = new Object({
                    ocid: release.ocid,
                    'contracts/id': (contract.id === undefined ? '' : contract.id),
                    'contracts/awardID': (contract.awardID === undefined ? '' : contract.awardID),
                    'contracts/title': (contract.title === undefined ? '' : contract.title),
                    'contracts/description': (contract.description === undefined ? '' : contract.description),
                    'contracts/status': (contract.status === undefined ? '' : contract.status),
                    'contracts/period/startDate': ((contract.period !== undefined) ? (contract.period.startDate !== undefined ? contract.period.startDate : '') : ''),
                    'contracts/period/endDate': ((contract.period !== undefined) ? (contract.period.endDate !== undefined ? contract.period.endDate : '') : ''),
                    'contracts/value/netAmount': ((contract.value !== undefined) ? (contract.value.amount !== undefined ? contract.value.amount : '') : ''),
                    'contracts/value/amount': ((contract.value !== undefined) ? (contract.value.amount !== undefined ? contract.value.amount : '') : ''),
                    'contracts/value/currency': ((contract.value !== undefined) ? (contract.value.currency !== undefined ? contract.value.currency : '') : ''),
                    'contracts/value/exchangeRates/currency':  ((contract.value !== undefined) ? (contract.value.exchangeRates !== undefined ? (contract.value.exchangeRates[0].currency !== undefined ? contract.value.exchangeRates[0].currency : '') : '') : ''),
                    'contracts/value/exchangeRates/rate': ((contract.value !== undefined) ? (contract.value.exchangeRates !== undefined ? (contract.value.exchangeRates[0].rate !== undefined ? contract.value.exchangeRates[0].rate : '') : '') : ''),
                    'contracts/value/exchangeRates/date': ((contract.value !== undefined) ? (contract.value.exchangeRates !== undefined ? (contract.value.exchangeRates[0].date !== undefined ? contract.value.exchangeRates[0].date : '') : '') : ''),
                    'contracts/value/exchangeRates/source': ((contract.value !== undefined) ? (contract.value.exchangeRates !== undefined ? (contract.value.exchangeRates[0].source !== undefined ? contract.value.exchangeRates[0].source : '') : '') : ''),
                    'contracts/dateSigned': (contract.dateSigned === undefined ? '' : contract.dateSigned),
                    'surveillanceMechanisms': ((contract.surveillanceMechanisms !== undefined) ? contract.surveillanceMechanisms[0] : ''), 
                  })
                  arrayContracts.push(objContract);
                  if(contract.items !== undefined){
                    if(contract.items.length > 0){
                      contract.items.forEach(item => {
                        var objContractItem = new Object({
                          ocid: release.ocid,
                          'contracts/id': (contract.id === undefined ? '' : contract.id),
                          'contracts/awardID': (contract.awardID === undefined ? '' : contract.awardID),
                          'contracts/items/id': (item.id === undefined ? '' : item.id),
                          'contracts/items/description': (item.description === undefined ? '' : item.description),
                          'contracts/items/classification/scheme': ((item.classification !== undefined) ? item.classification.scheme : ''),
                          'contracts/items/classification/id': ((item.classification !== undefined) ? item.classification.id : ''),
                          'contracts/items/classification/description': ((item.classification !== undefined) ? item.classification.description : ''),
                          'contracts/items/quantity': (item.quantity === undefined ? '' : item.quantity),
                          'contracts/items/unit/name': (item.unit === undefined ? '' : (item.unit.name === undefined ? '' : item.unit.name)),
                          'contracts/items/unit/value/amount': (item.unit === undefined ? '' : (item.unit.value === undefined ? '' : (item.unit.value.amount === undefined ? '' : item.unit.value.amount))),
                          'contracts/items/unit/value/netAmount': (item.unit === undefined ? '' : (item.unit.value === undefined ? '' : (item.unit.value.amount === undefined ? '' : item.unit.value.amount))),
                          'contracts/items/unit/value/currency': (item.unit === undefined ? '' : (item.unit.value === undefined ? '' : (item.unit.value.currency === undefined ? '' : item.unit.value.currency))),
                          'contracts/items/deliveryLocation/geometry/type': ((item.deliveryLocation !== undefined) ? (item.deliveryLocation.geometry !== undefined ? item.deliveryLocation.geometry.type : '') : ''),
                          'contracts/items/deliveryLocation/geometry/coordinates': ((item.deliveryLocation !== undefined) ? (item.deliveryLocation.geometry !== undefined ? (item.deliveryLocation.geometry.coordinates !== undefined ? item.deliveryLocation.geometry.coordinates[0]+','+item.deliveryLocation.geometry.coordinates[1] : '') : '') : ''),
                          'contracts/items/deliveryAddress/streetAddress': (item.deliveryAddress === undefined ? '' : (item.deliveryAddress.streetAddress === undefined ? '' : item.deliveryAddress.streetAddress)),
                          'contracts/items/deliveryAddress/locality': (item.deliveryAddress === undefined ? '' : (item.deliveryAddress.locality === undefined ? '' : item.deliveryAddress.locality)),
                          'contracts/items/deliveryAddress/postalCode': (item.deliveryAddress === undefined ? '' : (item.deliveryAddress.postalCode === undefined ? '' : item.deliveryAddress.postalCode)),
                          'contracts/items/deliveryAddress/countryName': (item.deliveryAddress === undefined ? '' : (item.deliveryAddress.countryName === undefined ? '' : item.deliveryAddress.countryName)),
                        });
                        arrayContractsItems.push(objContractItem);
                      });
                    }
                  }
                  if(contract.documents !== undefined){
                    if(contract.documents.length > 0){
                      contract.documents.forEach(document => {
                        var objContractItem = new Object({
                          ocid: release.ocid,
                          'contracts/id': (contract.id === undefined ? '' : contract.id),
                          'contracts/awardID': (contract.awardID === undefined ? '' : contract.awardID),
                          'contracts/documents/id': (document.id === undefined ? '' : document.id),
                          'contracts/documents/documentType': (document.documentType === undefined ? '' : document.documentType),
                          'contracts/documents/title': (document.title === undefined ? '' : document.title),
                          'contracts/documents/description': (document.description === undefined ? '' : document.description),
                          'contracts/documents/url': (document.url === undefined ? '' : document.url),
                          'contracts/documents/datePublished': (document.datePublished === undefined ? '' : document.datePublished),
                          'contracts/documents/dateModified': (document.dateModified === undefined ? '' : document.dateModified),
                          'contracts/documents/format': (document.format === undefined ? '' : document.format),
                          'contracts/documents/language': (document.language === undefined ? '' : document.language),
                        });
                        arrayContractsdocuments.push(objContractItem);
                      })
                    }
                  }
                  if(contract.amendments !== undefined){
                    if(contract.amendments.length > 0){
                      contract.amendments.forEach(amendment => {
                        var objAmendment = new Object({
                          ocid: release.ocid,
                          'contracts/id': (contract.id === undefined ? '' : contract.id),
                          'contracts/awardID': (contract.awardID === undefined ? '' : contract.awardID),
                          'contracts/amendments/date': (amendment.date === undefined ? '' : amendment.date),
                          'contracts/amendments/rationale': (amendment.rationale === undefined ? '' : amendment.rationale),
                          'contracts/amendments/id': (amendment.id === undefined ? '' : amendment.id),
                          'contracts/amendments/description': (amendment.description === undefined ? '' : amendment.description),
                        });
                        arrayContractsAmendments.push(objAmendment);
                      })
                    }
                  }
                  if(contract.guarantees !== undefined){
                    if(contract.guarantees.length > 0){
                      contract.guarantees.forEach(guarantee => {
                        var objGuarantee = new Object({
                          ocid: release.ocid,
                          'contracts/id': (contract.id === undefined ? '' : contract.id),
                          'contracts/awardID': (contract.awardID === undefined ? '' : contract.awardID),
                          'contracts/guarantees/id': (guarantee.id === undefined ? '' : guarantee.id),
                          'contracts/guarantees/type': (guarantee.type === undefined ? '' : guarantee.type),
                          'contracts/guarantees/date': (guarantee.date === undefined ? '' : guarantee.date),
                          'contracts/guarantees/obligations': (guarantee.obligations === undefined ? '' : guarantee.obligations),
                          'contracts/guarantees/value/amount': (guarantee.value === undefined ? '' : (guarantee.value.amount === undefined ? '' : guarantee.value.amount)),
                          'contracts/guarantees/value/currency': (guarantee.value === undefined ? '' : (guarantee.value.currency === undefined ? '' : guarantee.value.currency)),
                          'contracts/guarantees/guarantor/name': (guarantee.guarantor === undefined ? '' : (guarantee.guarantor.name === undefined ? '' : guarantee.guarantor.name)),
                          'contracts/guarantees/guarantor/id': (guarantee.guarantor === undefined ? '' : (guarantee.guarantor.id === undefined ? '' : guarantee.guarantor.id)),
                          'contracts/guarantees/period/startDate': (guarantee.period === undefined ? '' : (guarantee.period.startDate === undefined ? '' : guarantee.period.startDate)),
                          'contracts/guarantees/period/endDate': (guarantee.period === undefined ? '' : (guarantee.period.endDate === undefined ? '' : guarantee.period.endDate)),
                        });
                        arrayContractsGuarantees.push(objGuarantee);
                      })
                    }
                  }
                  if(contract.implementation !== undefined){
                    var objGuarantee = new Object({
                      ocid: release.ocid,
                      'contracts/id': (contract.id === undefined ? '' : contract.id),
                      'contracts/awardID': (contract.awardID === undefined ? '' : contract.awardID),
                      'contracts/implementation/status': (contract.implementation === undefined ? '' : (contract.implementation.status === undefined ? '' : contract.implementation.status)),
                    });
                    arrayContractsImplementation.push(objGuarantee);
                    if(contract.implementation.transactions !== undefined){
                      if(contract.implementation.transactions.length > 0){
                        contract.implementation.transactions.forEach(transaction => {
                          var objTransaction = new Object({
                            ocid: release.ocid,
                            'contracts/id': (contract.id === undefined ? '' : contract.id),
                            'contracts/awardID': (contract.awardID === undefined ? '' : contract.awardID),
                            'contracts/implementation/transactions/id': (transaction.id === undefined ? '' : transaction.id),
                            'contracts/implementation/transactions/date': (transaction.date === undefined ? '' : transaction.date),
                            'contracts/implementation/transactions/value/netAmount': (transaction.value === undefined ? '' : (transaction.value.amount === undefined ? '' : transaction.value.amount)),
                            'contracts/implementation/transactions/value/amount': (transaction.value === undefined ? '' : (transaction.value.amount === undefined ? '' : transaction.value.amount)),
                            'contracts/implementation/transactions/value/currency': (transaction.value === undefined ? '' : (transaction.value.currency === undefined ? '' : transaction.value.currency)),
                            'contracts/implementation/transactions/payer/name': (transaction.payer === undefined ? '' : (transaction.payer.name === undefined ? '' : transaction.payer.name)),
                            'contracts/implementation/transactions/payer/id': (transaction.payer === undefined ? '' : (transaction.payer.id === undefined ? '' : transaction.payer.id)),
                            'contracts/implementation/transactions/payee/id': (transaction.payee === undefined ? '' : (transaction.payee.id === undefined ? '' : transaction.payee.id)),
                            'contracts/implementation/transactions/payee/name': (transaction.payee === undefined ? '' : (transaction.payee.name === undefined ? '' : transaction.payee.name)),
                            'contracts/implementation/transactions/paymentMethod': (transaction.paymentMethod === undefined ? '' : transaction.paymentMethod),
                            
                          });
                          arrayContractsImplementationTrans.push(objTransaction);
                        })
                      }
                    }
                    if(contract.implementation.milestones !== undefined){
                      if(contract.implementation.milestones.length > 0){
                        contract.implementation.milestones.forEach(milestone => {
                          var objMilestone = new Object({
                            ocid: release.ocid,
                            'contracts/id': (contract.id === undefined ? '' : contract.id),
                            'contracts/awardID': (contract.awardID === undefined ? '' : contract.awardID),
                            'implementation/milestones/id': (milestone.id === undefined ? '' : milestone.id),
                            'implementation/milestones/title': (milestone.title === undefined ? '' : milestone.title),
                            'implementation/milestones/type': (milestone.type === undefined ? '' : milestone.type),
                            'implementation/milestones/description': (milestone.description === undefined ? '' : milestone.description),
                            'implementation/milestones/dueDate': (milestone.dueDate === undefined ? '' : milestone.dueDate),
                            'implementation/milestones/dateModified': (milestone.dateModified === undefined ? '' : milestone.dateModified),
                            'implementation/milestones/status': (milestone.status === undefined ? '' : milestone.status),
                          });
                          arrayContractsImplementationMilestone.push(objMilestone);
                        })
                      }
                    }
                    if(contract.implementation.documents !== undefined){
                      if(contract.implementation.documents.length > 0){
                        contract.implementation.documents.forEach(document => {
                          var objDocuments = new Object({
                            ocid: release.ocid,
                            'contracts/id': (contract.id === undefined ? '' : contract.id),
                            'contracts/awardID': (contract.awardID === undefined ? '' : contract.awardID),
                            'implementation/documents/id': (document.id === undefined ? '' : document.id),
                            'implementation/documents/documentType': (document.documentType === undefined ? '' : document.documentType),
                            'implementation/documents/title': (document.title === undefined ? '' : document.title),
                            'implementation/documents/description': (document.description === undefined ? '' : document.description),
                            'implementation/documents/url': (document.url === undefined ? '' : document.url),
                            'implementation/documents/datePublished': (document.datePublished === undefined ? '' : document.datePublished),
                            'implementation/documents/dateModified': (document.dateModified === undefined ? '' : document.dateModified),
                            'implementation/documents/format': (document.format === undefined ? '' : document.format),
                            'implementation/documents/language': (document.language === undefined ? '' : document.language),
                          });
                          arrayContractsImplementationDocuments.push(objDocuments);
                        })
                      }
                    }
                  }
                });
              }
            }
            if(release.relatedProcesses !== undefined){
              if(release.relatedProcesses.length > 0){
                release.relatedProcesses.forEach(relatedProcess => {
                  var objRelatedProcess = new Object({
                    ocid: release.ocid,
                    'relatedProcesses/id': (relatedProcess.id === undefined ? '' : relatedProcess.id),
                    'relatedProcesses/relationship': (relatedProcess.relationship[0] === undefined ? '' : relatedProcess.relationship[0]),
                    'relatedProcesses/title': (relatedProcess.title === undefined ? '' : relatedProcess.title),
                    'relatedProcesses/scheme': (relatedProcess.scheme === undefined ? '' : relatedProcess.scheme),
                    'relatedProcesses/identifier': (relatedProcess.identifier === undefined ? '' : relatedProcess.identifier),
                    'relatedProcesses/uri': (relatedProcess.uri === undefined ? '' : relatedProcess.uri),
                  });
                  arrayRelatedProcesses.push(objRelatedProcess);
                });

              }
            }
          });
          }
          consecutivo++;
        }); 
        objResult.arrayIndice = arrayIndice;
        objResult.arrayReleasePackage = arrayReleasePackage;
        objResult.arrayExtensions2 = arrayExtensions2;
        objResult.arrayPublishers = arrayPublishers;
        objResult.arrayReleases = arrayReleases;
        objResult.arrayParties = arrayParties;
        objResult.arrayMember = arrayMember;
        objResult.arrayAdditionalContactPoint = arrayAdditionalContactPoint;
        objResult.arrayPlanning = arrayPlanning;
        objResult.arrayRequestingUnit = arrayRequestingUnit;
        objResult.arrayContractingUnit = arrayContractingUnit;
        objResult.arrayResponsibleUnit = arrayResponsibleUnit;
        objResult.arrayBudget = arrayBudget;
        objResult.arrayBudgetLinesComponent = arrayBudgetLinesComponent;
        objResult.arrayBudgetLinesMeasure = arrayBudgetLinesMeasure;
        objResult.arrayPlanningDocuments = arrayPlanningDocuments;
        objResult.arrayRequestsForQuotes = arrayRequestsForQuotes;
        objResult.arrayRequestsForQuotesItems = arrayRequestsForQuotesItems;
        objResult.arrayRequestsForQuotesinvitedSuppliers = arrayRequestsForQuotesinvitedSuppliers;
        objResult.arrayRequestsForQuotesQuotes = arrayRequestsForQuotesQuotes;
        objResult.arrayRequestsForQuotesQuotesItems = arrayRequestsForQuotesQuotesItems;
        objResult.arrayTender = arrayTender;
        objResult.arrayContractsItems = arrayContractsItems;
        objResult.arrayTenderes = arrayTenderes;
        objResult.arrayTenderItems = arrayTenderItems;
        objResult.arrayTenderDocuments = arrayTenderDocuments;
        objResult.arrayTenderMilestones = arrayTenderMilestones;
        objResult.arrayTenderAmendment = arrayTenderAmendment;
        objResult.arrayTenderClarificationMeeting = arrayTenderClarificationMeeting;
        objResult.arrayBuyer = arrayBuyer;
        objResult.arrayTenderClarificationMeetingAttendees = arrayTenderClarificationMeetingAttendees;
        objResult.arrayTenderClarificationMeetingOfficials = arrayTenderClarificationMeetingOfficials;
        objResult.arrayAwars = arrayAwars;
        objResult.arrayAwarsSuppliers = arrayAwarsSuppliers;
        objResult.arrayAwarsDocuments = arrayAwarsDocuments;
        objResult.arrayAwarsAmendments = arrayAwarsAmendments;
        objResult.arrayContracts = arrayContracts;
        objResult.arrayContractsdocuments = arrayContractsdocuments;
        objResult.arrayContractsAmendments = arrayContractsAmendments;
        objResult.arrayContractsGuarantees = arrayContractsGuarantees;
        objResult.arrayContractsImplementation = arrayContractsImplementation;
        objResult.arrayContractsImplementationTrans = arrayContractsImplementationTrans;
        objResult.arrayContractsImplementationMilestone = arrayContractsImplementationMilestone;
        objResult.arrayContractsImplementationDocuments = arrayContractsImplementationDocuments;
        objResult.arrayRelatedProcesses = arrayRelatedProcesses;
        // console.log(JSON.stringify(objResult))
        return objResult;
      }
      function generateExcel(data){
        const EXCEL_TYPE = 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8'
        const EXCEL_EXTENSION = '.xlsx';
        var arraySheetNames = new Array();
        if(data.arrayIndice.length !== 0){
          var worksheetIndex = XLSX.utils.json_to_sheet(data.arrayIndice);
          var SheetName = 'Index';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayReleasePackage.length !== 0){
          var worksheet = XLSX.utils.json_to_sheet(data.arrayReleasePackage);
          var SheetName = '1000';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayExtensions2.length !== 0){
          var worksheetExtensions = XLSX.utils.json_to_sheet(data.arrayExtensions2);
          var SheetName = '1100';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayPublishers.length !== 0){
          var worksheetPublisher = XLSX.utils.json_to_sheet(data.arrayPublishers);
          var SheetName = '1200';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayReleases.length !== 0){
          var worksheetRelease = XLSX.utils.json_to_sheet(data.arrayReleases);
          var SheetName = '1300';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayParties.length !== 0){
          var worksheetReleaseParties = XLSX.utils.json_to_sheet(data.arrayParties);
          var SheetName = '2000';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayMember.length !== 0){
          var worksheetReleasePartiesMember = XLSX.utils.json_to_sheet(data.arrayMember);
          var SheetName = '2100';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayAdditionalContactPoint.length !== 0){
          var worksheetReleasePartiesAContactPoint = XLSX.utils.json_to_sheet(data.arrayAdditionalContactPoint);
          var SheetName = '2200';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayPlanning.length !== 0){
          var worksheetReleasePlanning = XLSX.utils.json_to_sheet(data.arrayPlanning);
          var SheetName = '3000';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayRequestingUnit.length !== 0){
          var worksheetReleasePlanningRequestingUnit = XLSX.utils.json_to_sheet(data.arrayRequestingUnit);
          var SheetName = '3100';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayContractingUnit.length !== 0){
          var worksheetReleasePlanningContractingUnit = XLSX.utils.json_to_sheet(data.arrayContractingUnit);
          var SheetName = '3200';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayResponsibleUnit.length !== 0){
          var worksheetReleasePlanningResponsibleUnit = XLSX.utils.json_to_sheet(data.arrayResponsibleUnit);
          var SheetName = '3300';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayBudget.length !== 0){
          var worksheetReleasePlanningBudgetBreakdown = XLSX.utils.json_to_sheet(data.arrayBudget);
          var SheetName = '3400';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayBudgetLinesComponent.length !== 0){
          var worksheetBudgetLinesComponent = XLSX.utils.json_to_sheet(data.arrayBudgetLinesComponent);
          var SheetName = '3500';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayBudgetLinesMeasure.length !== 0){
          var worksheetBudgetLinesMeasure = XLSX.utils.json_to_sheet(data.arrayBudgetLinesMeasure);
          var SheetName = '3600';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayPlanningDocuments.length !== 0){
          var worksheetPlanningDocuments = XLSX.utils.json_to_sheet(data.arrayPlanningDocuments);
          var SheetName = '3700';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayRequestsForQuotes.length !== 0){
          var worksheetRequestsForQuotes = XLSX.utils.json_to_sheet(data.arrayRequestsForQuotes);
          var SheetName = '3800';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayRequestsForQuotesItems.length !== 0){
          var worksheetRequestsForQuotesItems = XLSX.utils.json_to_sheet(data.arrayRequestsForQuotesItems);
          var SheetName = '3900';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayRequestsForQuotesinvitedSuppliers.length !== 0){
          var worksheetRequestsForQuotesinvitedSupp = XLSX.utils.json_to_sheet(data.arrayRequestsForQuotesinvitedSuppliers);
          var SheetName = '4000';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayRequestsForQuotesQuotes.length !== 0){
          var worksheetRequestsForQuotesQuotes = XLSX.utils.json_to_sheet(data.arrayRequestsForQuotesQuotes);
          var SheetName = '4100';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayRequestsForQuotesQuotesItems.length !== 0){
          var worksheetRequestsForQuotesQuotesItems = XLSX.utils.json_to_sheet(data.arrayRequestsForQuotesQuotesItems);
          var SheetName = '4200';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayTender.length !== 0){
          var worksheetTender = XLSX.utils.json_to_sheet(data.arrayTender);
          var SheetName = '5000';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayTenderes.length !== 0){
          var worksheetArrayTenderes = XLSX.utils.json_to_sheet(data.arrayTenderes);
          var SheetName = '5100';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayTenderItems.length !== 0){
          var worksheetTenderItems = XLSX.utils.json_to_sheet(data.arrayTenderItems);
          var SheetName = '5200';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayTenderDocuments.length !== 0){
          var worksheetTenderDocuments = XLSX.utils.json_to_sheet(data.arrayTenderDocuments);
          var SheetName = '5300';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayTenderMilestones.length !== 0){
          var worksheetTenderMilestones = XLSX.utils.json_to_sheet(data.arrayTenderMilestones);
          var SheetName = '5400';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayTenderAmendment.length !== 0){
          var worksheetTenderAmendment = XLSX.utils.json_to_sheet(data.arrayTenderAmendment);
          var SheetName = '5500';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayTenderClarificationMeeting.length !== 0){
          var worksheetClarificationMeeting = XLSX.utils.json_to_sheet(data.arrayTenderClarificationMeeting);
          var SheetName = '5600';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayTenderClarificationMeetingAttendees.length !== 0){
          var worksheetTenderClarificationMeetingAttendees = XLSX.utils.json_to_sheet(data.arrayTenderClarificationMeetingAttendees);
          var SheetName = '5700';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayBuyer.length !== 0){
          var worksheetBuyer = XLSX.utils.json_to_sheet(data.arrayBuyer);
          var SheetName = '5800';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayTenderClarificationMeetingOfficials.length !== 0){
          var worksheetTenderClarificationMeetingOfficials = XLSX.utils.json_to_sheet(data.arrayTenderClarificationMeetingOfficials);
          var SheetName = '5900';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayAwars.length !== 0){
          var worksheetAwars = XLSX.utils.json_to_sheet(data.arrayAwars);
          var SheetName = '6000';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayAwarsSuppliers.length !== 0){
          var worksheetAwarsSuppliers = XLSX.utils.json_to_sheet(data.arrayAwarsSuppliers);
          var SheetName = '6100';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayAwarsDocuments.length !== 0){
          var worksheetAwarsDocuments = XLSX.utils.json_to_sheet(data.arrayAwarsDocuments);
          var SheetName = '6200';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayAwarsAmendments.length !== 0){
          var worksheetAwarsAmendments = XLSX.utils.json_to_sheet(data.arrayAwarsAmendments);
          var SheetName = '6300';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayContracts.length !== 0){
          var worksheetContracts = XLSX.utils.json_to_sheet(data.arrayContracts);
          var SheetName = '7000';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayContractsItems.length !== 0){
          var worksheetContractsItems = XLSX.utils.json_to_sheet(data.arrayContractsItems);
          var SheetName = '7100';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayContractsdocuments.length !== 0){
          var worksheetContractsdocuments = XLSX.utils.json_to_sheet(data.arrayContractsdocuments);
          var SheetName = '7200';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayContractsAmendments.length !== 0){
          var worksheetContractsAmendments = XLSX.utils.json_to_sheet(data.arrayContractsAmendments);
          var SheetName = '7300';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayContractsGuarantees.length !== 0){
          var worksheetContractsGuarantees = XLSX.utils.json_to_sheet(data.arrayContractsGuarantees);
          var SheetName = '7400';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayContractsImplementation.length !== 0){
          var worksheetContractsImplementation = XLSX.utils.json_to_sheet(data.arrayContractsImplementation);
          var SheetName = '8000';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayContractsImplementationTrans.length !== 0){
          var worksheetContractsImplementationTrans = XLSX.utils.json_to_sheet(data.arrayContractsImplementationTrans);
          var SheetName = '8100';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayContractsImplementationMilestone.length !== 0){
          var worksheetContractsImplementationMil = XLSX.utils.json_to_sheet(data.arrayContractsImplementationMilestone);
          var SheetName = '8200';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayContractsImplementationDocuments.length !== 0){
          var worksheetContractsImplementationDoc = XLSX.utils.json_to_sheet(data.arrayContractsImplementationDocuments);
          var SheetName = '8300';
          arraySheetNames.push(SheetName);
        }
        if(data.arrayRelatedProcesses.length !== 0){
          var worksheetRelatedProcesses = XLSX.utils.json_to_sheet(data.arrayRelatedProcesses);
          var SheetName = '9000';
          arraySheetNames.push(SheetName);
        }

        const workbook = {
          Sheets:{
            'Index': worksheetIndex,
            '1000': worksheet,
            '1100': worksheetExtensions,
            '1200': worksheetPublisher,
            '1300': worksheetRelease,
            '2000': worksheetReleaseParties,
            '2100': worksheetReleasePartiesMember,
            '2200': worksheetReleasePartiesAContactPoint,
            '3000': worksheetReleasePlanning,
            '3100': worksheetReleasePlanningRequestingUnit,
            '3200': worksheetReleasePlanningContractingUnit,
            '3300': worksheetReleasePlanningResponsibleUnit,
            '3400': worksheetReleasePlanningBudgetBreakdown,
            '3500': worksheetBudgetLinesComponent,
            '3600': worksheetBudgetLinesMeasure,
            '3700': worksheetPlanningDocuments,
            '3800': worksheetRequestsForQuotes,
            '3900': worksheetRequestsForQuotesItems,
            '4000': worksheetRequestsForQuotesinvitedSupp,
            '4100': worksheetRequestsForQuotesQuotes,
            '4200': worksheetRequestsForQuotesQuotesItems,
            '5000': worksheetTender,
            '5100': worksheetArrayTenderes,
            '5200': worksheetTenderItems,
            '5300': worksheetTenderDocuments,
            '5400': worksheetTenderMilestones,
            '5500': worksheetTenderAmendment,
            '5600': worksheetClarificationMeeting,
            '5700': worksheetTenderClarificationMeetingAttendees,
            '5800': worksheetBuyer,
            '5900': worksheetTenderClarificationMeetingOfficials,
            '6000': worksheetAwars,
            '6100': worksheetAwarsSuppliers,
            '6200': worksheetAwarsDocuments,
            '6300': worksheetAwarsAmendments,
            '7000': worksheetContracts,
            '7100': worksheetContractsItems,
            '7200': worksheetContractsdocuments,
            '7300': worksheetContractsAmendments,
            '7400': worksheetContractsGuarantees,
            '8000': worksheetContractsImplementation,
            '8100': worksheetContractsImplementationTrans,
            '8200': worksheetContractsImplementationMil,
            '8300': worksheetContractsImplementationDoc,
            '9000': worksheetRelatedProcesses,
          },
          SheetNames:arraySheetNames
        }
        const excelBuffer = XLSX.write(workbook,{bookType:'xlsx',type:'array'});
        const info = new Blob([excelBuffer],{type: EXCEL_TYPE});
        saveAs(info,`test_export_${new Date().getTime()}${EXCEL_EXTENSION}`)
      }
      function generateCSV(info){
        var data = generateData(info);
        if(data.arrayIndice.length !== 0){
          const headers = {
            Path: 'Path',
            Code: 'Code'
          };
          exportCSVFile(headers,data.arrayIndice,'index')
        }
        
        if(data.arrayReleasePackage.length !== 0){
          const headers = {
            ocid: 'ocid',
            uri: 'uri',
            version: 'version',
            publishedDate: 'publishedDate',
            license: 'license',
            publicationPolicy: 'publicationPolicy'
          };
          exportCSVFile(headers,data.arrayReleasePackage,'1000')
        }

        if(data.arrayExtensions2.length !== 0){
          const headers = {
            ocid: 'ocid',
            extensions: 'extensions'
          };
          exportCSVFile(headers,data.arrayExtensions2,'1100')
        }
        
        if(data.arrayPublishers.length !== 0){
          const headers = {
            ocid: 'ocid',
            'publisher/name': 'publisher/name',
            'publisher/scheme': 'publisher/scheme',
            'publisher/uid': 'publisher/uid',
            'publisher/uri': 'publisher/uri'
          };
          exportCSVFile(headers,data.arrayPublishers,'1200')
        }
        if(data.arrayReleases.length !== 0){
          const headers = {
            ocid: 'ocid',
            id: 'id',
            date: 'date',
            initiationType: 'initiationType',
            language: 'language',
            tag: 'tag'
          };
          exportCSVFile(headers,data.arrayReleases,'1300')
        }
        if(data.arrayParties.length !== 0){
          const headers = {
            ocid: 'ocid',
            'parties/name': 'parties/name',
            'parties/id': 'parties/id',
            'parties/position': 'parties/position',
            'parties/identifier/scheme': 'parties/identifier/scheme',
            'parties/identifier/id': 'parties/identifier/id',
            'parties/identifier/legalName': 'parties/identifier/legalName',
            'parties/identifier/legalPersonality': 'parties/identifier/legalPersonality',
            'parties/identifier/givenName': 'parties/identifier/givenName',
            'parties/identifier/patronymicName': 'parties/identifier/patronymicName',
            'parties/identifier/matronymicName': 'parties/identifier/matronymicName',
            'parties/address/streetAddress': 'parties/address/streetAddress',
            'parties/address/locality': 'parties/address/locality',
            'parties/address/region': 'parties/address/region',
            'parties/address/postalCode': 'parties/address/postalCode',
            'parties/address/countryName': 'parties/address/countryName',
            'parties/contactPoint/name': 'parties/contactPoint/name',
            'parties/contactPoint/email': 'parties/contactPoint/email',
            'parties/contactPoint/telephone': 'parties/contactPoint/telephone',
            'parties/contactPoint/faxNumber': 'parties/contactPoint/faxNumber',
            'parties/contactPoint/url': 'parties/contactPoint/url',
            'parties/contactPoint/type': 'parties/contactPoint/type',
            'parties/contactPoint/givenName': 'parties/contactPoint/givenName',
            'parties/contactPoint/patronymicName': 'parties/contactPoint/patronymicName',
            'parties/contactPoint/matronymicName': 'parties/contactPoint/matronymicName',
            'parties/roles': 'parties/roles',
          };
          exportCSVFile(headers,data.arrayParties,'2000')
        }
        if(data.arrayMember.length !== 0){
          const headers = {
            ocid: 'ocid',
            'parties/id' : 'parties/id',
            'parties/memberOf/id' : 'parties/memberOf/id',
            'parties/memberOf/name' : 'parties/memberOf/name'
          };
          exportCSVFile(headers,data.arrayMember,'2100')
        }
        if(data.arrayAdditionalContactPoint.length !== 0){
          const headers = {
            ocid: 'ocid',
            'parties/id' : 'parties/id',
            'parties/additionalContacPoints/contactPointType' : 'parties/additionalContacPoints/contactPointType',
            'parties/additionalContacPoints/name' : 'parties/additionalContacPoints/name',
            'parties/additionalContacPoints/givenName' : 'parties/additionalContacPoints/givenName',
            'parties/additionalContacPoints/patronymicName' : 'parties/additionalContacPoints/patronymicName',
            'parties/additionalContacPoints/matronymicName' : 'parties/additionalContacPoints/matronymicName',
            'parties/additionalContacPoints/email' : 'parties/additionalContacPoints/email',
            'parties/additionalContacPoints/telephone' : 'parties/additionalContacPoints/telephone',
            'parties/additionalContacPoints/faxNumber' : 'parties/additionalContacPoints/faxNumber',
            'parties/additionalContacPoints/url' :'parties/additionalContacPoints/url',
            'parties/additionalContacPoints/availableLanguage': 'parties/additionalContacPoints/availableLanguage',
          };
          exportCSVFile(headers,data.arrayAdditionalContactPoint,'2200')
        }
        if(data.arrayPlanning.length !== 0){
          const headers = {
            ocid: 'ocid',
            rationale: 'rationale',
            hasQuotes: 'hasquotes'
          };
          exportCSVFile(headers,data.arrayPlanning,'3000')
        }
        if(data.arrayRequestingUnit.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/requestingUnits/id' : 'planning/requestingUnits/id',
            'planning/requestingUnits/name' : 'planning/requestingUnits/name'
          };
          exportCSVFile(headers,data.arrayRequestingUnit,'3100')
        }
        if(data.arrayContractingUnit.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/contractingUnits/id' : 'planning/contractingUnits/id',
            'planning/contractingUnits/name' : 'planning/contractingUnits/name'
          };
          exportCSVFile(headers,data.arrayContractingUnit,'3200')
        }
        if(data.arrayResponsibleUnit.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/responsibleUnits/id' : 'planning/responsibleUnits/id',
            'planning/responsibleUnits/name' : 'planning/responsibleUnits/name'
          };
          exportCSVFile(headers,data.arrayResponsibleUnit,'3300')
        }
        if(data.arrayBudget.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/budget/budgetBreakdown/id' : 'planning/budget/budgetBreakdown/id',
            'planning/budget/budgetBreakdown/description' : 'planning/budget/budgetBreakdown/description',
            'planning/budget/budgetBreakdown/origin' : 'planning/budget/budgetBreakdown/origin',
            'planning/budget/budgetBreakdown/fundType' : 'planning/budget/budgetBreakdown/fundType',
            'planning/budget/budgetBreakdown/period/startDate' : 'planning/budget/budgetBreakdown/period/startDate',
            'planning/budget/budgetBreakdown/period/endDate' : 'planning/budget/budgetBreakdown/period/endDate',
            'planning/budget/budgetBreakdown/value/amount' : 'planning/budget/budgetBreakdown/value/amount',
            'planning/budget/budgetBreakdown/value/currency' : 'planning/budget/budgetBreakdown/value/currency',
            'planning/budget/budgetBreakdown/sourceParty/name' : 'planning/budget/budgetBreakdown/sourceParty/name',
            'planning/budget/budgetBreakdown/sourceParty/id' : 'planning/budget/budgetBreakdown/sourceParty/id'
          };
          exportCSVFile(headers,data.arrayBudget,'3400')
        }
        if(data.arrayBudgetLinesComponent.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/budget/budgetBreakdown/budgetLines/components/name' : 'planning/budget/budgetBreakdown/budgetLines/components/name',
            'planning/budget/budgetBreakdown/budgetLines/components/level' : 'planning/budget/budgetBreakdown/budgetLines/components/level',
            'planning/budget/budgetBreakdown/budgetLines/components/code' : 'planning/budget/budgetBreakdown/budgetLines/components/code',
            'planning/budget/budgetBreakdown/budgetLines/components/description': 'planning/budget/budgetBreakdown/budgetLines/components/description'
          };
          exportCSVFile(headers,data.arrayBudgetLinesComponent,'3500')
        }
        if(data.arrayBudgetLinesMeasure.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/budget/budgetBreakdown/budgetLines/measures/id' : 'planning/budget/budgetBreakdown/budgetLines/measures/id',
            'planning/budget/budgetBreakdown/budgetLines/measures/update' : 'planning/budget/budgetBreakdown/budgetLines/measures/update',
            'planning/budget/budgetBreakdown/budgetLines/measures/amount' : 'planning/budget/budgetBreakdown/budgetLines/measures/amount',
            'planning/budget/budgetBreakdown/budgetLines/measures/currency' : 'planning/budget/budgetBreakdown/budgetLines/measures/currency'
          };
          exportCSVFile(headers,data.arrayBudgetLinesMeasure,'3600')
        }
        if(data.arrayPlanningDocuments.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/documents/id' :'planning/documents/id',
            'planning/documents/documentType' : 'planning/documents/documentType',
            'planning/documents/title' : 'planning/documents/title',
            'planning/documents/description' : 'planning/documents/description',
            'planning/documents/url' : 'planning/documents/url',
            'planning/documents/datePublished' : 'planning/documents/datePublished',
            'planning/documents/dateModified' : 'planning/documents/dateModified',
            'planning/documents/format' : 'planning/documents/format',
            'planning/documents/language' : 'planning/documents/language'
          };
          exportCSVFile(headers,data.arrayPlanningDocuments,'3700')
        }
        if(data.arrayRequestsForQuotes.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/requestsForQuotes/id' : 'planning/requestsForQuotes/id',
            'planning/requestsForQuotes/title' : 'planning/requestsForQuotes/title',
            'planning/requestsForQuotes/description' : 'planning/requestsForQuotes/description',
            'planning/requestsForQuotes/period/startDate' : 'planning/requestsForQuotes/period/startDate',
            'planning/requestsForQuotes/period/endDate' : 'planning/requestsForQuotes/period/endDate'
          };
          exportCSVFile(headers,data.arrayRequestsForQuotes,'3800')
        }
        if(data.arrayRequestsForQuotesItems.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/requestsForQuotes/id' : 'planning/requestsForQuotes/id',
            'planning/requestsForQuotes/items/id' : 'planning/requestsForQuotes/items/id',
            'planning/requestsForQuotes/items/description' : 'planning/requestsForQuotes/items/description',
            'planning/requestsForQuotes/items/quantity' : 'planning/requestsForQuotes/items/quantity',
            'planning/requestsForQuotes/items/classification/id' : 'planning/requestsForQuotes/items/classification/id',
            'planning/requestsForQuotes/items/classification/description' : 'planning/requestsForQuotes/items/classification/description',
            'planning/requestsForQuotes/items/unit/name' : 'planning/requestsForQuotes/items/unit/name'
          };
          exportCSVFile(headers,data.arrayRequestsForQuotesItems,'3900')
        }
        if(data.arrayRequestsForQuotesinvitedSuppliers.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/requestsForQuotes/id' : 'planning/requestsForQuotes/id',
            'planning/invitedSuppliers/name' : 'planning/invitedSuppliers/name',
            'planning/invitedSuppliers/id' : 'planning/invitedSuppliers/id'
          };
          exportCSVFile(headers,data.arrayRequestsForQuotesinvitedSuppliers,'4000')
        }
        if(data.arrayRequestsForQuotesQuotes.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/requestsForQuotes/id' : 'planning/requestsForQuotes/id',
            'planning/requestsForQuotes/quotes/id' : 'planning/requestsForQuotes/quotes/id',
            'planning/requestsForQuotes/quotes/description' : 'planning/requestsForQuotes/quotes/description',
            'planning/requestsForQuotes/quotes/date' : 'planning/requestsForQuotes/quotes/date',
            'planning/requestsForQuotes/quotes/value/amount' : 'planning/requestsForQuotes/quotes/value/amount',
            'planning/requestsForQuotes/quotes/quotePeriod/startDate' : 'planning/requestsForQuotes/quotes/quotePeriod/startDate',
            'planning/requestsForQuotes/quotes/quotePeriod/endDate' : 'planning/requestsForQuotes/quotes/quotePeriod/endDate',
            'planning/requestsForQuotes/quotes/issuingSupplier/name' : 'planning/requestsForQuotes/quotes/issuingSupplier/name',
            'planning/requestsForQuotes/quotes/issuingSupplier/id' : 'planning/requestsForQuotes/quotes/issuingSupplier/id'
          };
          exportCSVFile(headers,data.arrayRequestsForQuotesQuotes,'4100')
        }
        if(data.arrayRequestsForQuotesQuotesItems.length !== 0){
          const headers = {
            ocid: 'ocid',
            'planning/requestsForQuotes/id' : 'planning/requestsForQuotes/id',
            'planning/requestsForQuotes/quotes/id' : 'planning/requestsForQuotes/quotes/id',
            'planning/requestsForQuotes/quotes/items/id' : 'planning/requestsForQuotes/quotes/items/id',
            'planning/requestsForQuotes/quotes/items/classification/id' : 'planning/requestsForQuotes/quotes/items/classification/id',
            'planning/requestsForQuotes/quotes/items/classification/description' : 'planning/requestsForQuotes/quotes/items/classification/description',
            'planning/requestsForQuotes/quotes/items/unit/name' : 'planning/requestsForQuotes/quotes/items/unit/name',
            'planning/requestsForQuotes/quotes/items/unit/value/amount' : 'planning/requestsForQuotes/quotes/items/unit/value/amount',
            'planning/requestsForQuotes/quotes/issuingSupplier/name' : 'planning/requestsForQuotes/quotes/issuingSupplier/name',
            'planning/requestsForQuotes/quotes/issuingSupplier/id' : 'planning/requestsForQuotes/quotes/issuingSupplier/id'
          };
          exportCSVFile(headers,data.arrayRequestsForQuotesQuotesItems,'4200')
        }
        if(data.arrayTender.length !== 0){
          const headers = {
            ocid: 'ocid',
            'tender/id': 'tender/id',
            'tender/title': 'tender/title',
            'tender/description': 'tender/description',
            'tender/status': 'tender/status',
            'tender/procuringEntity/name': 'tender/procuringEntity/name',
            'tender/procuringEntity/id': 'tender/procuringEntity/id',
            'tender/value/amount': 'tender/value/amount',
            'tender/value/currency': 'tender/value/currency',
            'tender/minValue/amount': 'tender/minValue/amount',
            'tender/minValue/currency': 'tender/minValue/currency',
            'tender/procurementMethod': 'tender/procurementMethod',
            'tender/procurementMethodDetails': 'tender/procurementMethodDetails',
            'tender/procurementMethodRationale': 'tender/procurementMethodRationale',
            'tender/mainProcurementCategory': 'tender/mainProcurementCategory',
            'tender/additionalProcurementCategories': 'tender/additionalProcurementCategories',
            'tender/awardCriteria': 'tender/awardCriteria',
            'tender/awardCriteriaDetails': 'tender/awardCriteriaDetails',
            'tender/submissionMethod': 'tender/submissionMethod',
            'tender/submissionMethodDetails': 'tender/submissionMethodDetails',
            'tender/tenderPeriod/startDate': 'tender/tenderPeriod/startDate',
            'tender/tenderPeriod/endDate': 'tender/tenderPeriod/endDate',
            'tender/enquiryPeriod/startDate': 'tender/enquiryPeriod/startDate',
            'tender/enquiryPeriod/endDate': 'tender/enquiryPeriod/endDate',
            'tender/hasEnquiries': 'tender/hasEnquiries',
            'tender/eligibilityCriteria': 'tender/eligibilityCriteria',
            'tender/awardPeriod/startDate': 'tender/awardPeriod/startDate',
            'tender/awardPeriod/endDate': 'tender/awardPeriod/endDate',
            'tender/numberOfTenderers': 'tender/numberOfTenderers'
          };
          exportCSVFile(headers,data.arrayTender,'5000')
        }
        if(data.arrayTenderes.length !== 0){
          const headers = {
            ocid: 'ocid',
            'tender/tenderers/name': 'tender/tenderers/name',
            'tender/tenderers/id': 'tender/tenderers/id'
          };
          exportCSVFile(headers,data.arrayTenderes,'5100')
        }
        if(data.arrayTenderItems.length !== 0){
          const headers = {
            ocid: 'ocid',
            'tender/items/id': 'tender/items/id',
            'tender/items/description': 'tender/items/description',
            'tender/items/classification/scheme': 'tender/items/classification/scheme',
            'tender/items/classification/id': 'tender/items/classification/id',
            'tender/items/classification/description': 'tender/items/classification/description',
            'tender/items/quantity': 'tender/items/quantity',
            'tender/items/unit/name': 'tender/items/unit/name',
            'tender/items/unit/value/amount': 'tender/items/unit/value/amount',
            'tender/items/unit/value/netAmount': 'tender/items/unit/value/netAmount',
            'tender/items/unit/value/currency': 'tender/items/unit/value/currency',
            'tender/items/deliveryLocation/geometry/type': 'tender/items/deliveryLocation/geometry/type',
            'tender/items/deliveryLocation/geometry/coordinates': 'tender/items/deliveryLocation/geometry/coordinates',
            'tender/items/deliveryAddress/streetAddress': 'tender/items/deliveryAddress/streetAddress',
            'tender/items/deliveryAddress/locality': 'tender/items/deliveryAddress/locality',
            'tender/items/deliveryAddress/postalCode': 'tender/items/deliveryAddress/postalCode',
            'tender/items/deliveryAddress/countryName': 'tender/items/deliveryAddress/countryName'
          };
          exportCSVFile(headers,data.arrayTenderItems,'5200')
        }
        if(data.arrayTenderDocuments.length !== 0){
          const headers = {
            ocid: 'ocid',
            'tender/documents/id': 'tender/documents/id',
            'tender/documents/documentType': 'tender/documents/documentType',
            'tender/documents/title': 'tender/documents/title',
            'tender/documents/description': 'tender/documents/description',
            'tender/documents/url': 'tender/documents/url',
            'tender/documents/datePublished': 'tender/documents/datePublished',
            'tender/documents/dateModified': 'tender/documents/dateModified',
            'tender/documents/format': 'tender/documents/format',
            'tender/documents/language': 'tender/documents/language'
          };
          exportCSVFile(headers,data.arrayTenderDocuments,'5300')
        }
        if(data.arrayTenderMilestones.length !== 0){
          const headers = {
            ocid: 'ocid',
            'tender/milestones/id': 'tender/milestones/id',
            'tender/milestones/title': 'tender/milestones/title',
            'tender/milestones/type': 'tender/milestones/type',
            'tender/milestones/description': 'tender/milestones/description',
            'tender/milestones/dueDate': 'tender/milestones/dueDate',
            'tender/milestones/dateModified': 'tender/milestones/dateModified',
            'tender/milestones/status': 'tender/milestones/status'
          };
          exportCSVFile(headers,data.arrayTenderMilestones,'5400')
        }
        if(data.arrayTenderAmendment.length !== 0){
          const headers = {
            ocid: 'ocid',
            'tender/amendments/date': 'tender/amendments/date',
            'tender/amendments/rationale': 'tender/amendments/rationale',
            'tender/amendments/id':'tender/amendments/id',
            'tender/amendments/description': 'tender/amendments/description'
          };
          exportCSVFile(headers,data.arrayTenderAmendment,'5500')
        }
        if(data.arrayTenderClarificationMeeting.length !== 0){
          const headers = {
            ocid: 'ocid',
            'tender/clarificationMeetings/id': 'tender/clarificationMeetings/id',
            'tender/clarificationMeetings/date': 'tender/clarificationMeetings/date'
          };
          exportCSVFile(headers,data.arrayTenderClarificationMeeting,'5600')
        }
        if(data.arrayTenderClarificationMeetingAttendees.length !== 0){
          const headers = {
            ocid: 'ocid',
            'tender/clarificationMeetings/id': 'tender/clarificationMeetings/id',
            'tender/clarificationMeetings/attendees/name': 'tender/clarificationMeetings/attendees/name',
            'tender/clarificationMeetings/attendees/id': 'tender/clarificationMeetings/attendees/id'
          };
          exportCSVFile(headers,data.arrayTenderClarificationMeetingAttendees,'5700')
        }
        if(data.arrayBuyer.length !== 0){
          const headers = {
            ocid: 'ocid',
            'buyer/name':'buyer/name',
            'buyer/id': 'buyer/id'
          };
          exportCSVFile(headers,data.arrayBuyer,'5800')
        }
        if(data.arrayTenderClarificationMeetingOfficials.length !== 0){
          const headers = {
            ocid: 'ocid',
            'tender/clarificationMeetings/id': 'tender/clarificationMeetings/id',
            'tender/clarificationMeetings/officials/name': 'tender/clarificationMeetings/officials/name',
            'tender/clarificationMeetings/officials/id': 'tender/clarificationMeetings/officials/id'
          };
          exportCSVFile(headers,data.arrayTenderClarificationMeetingOfficials,'5900')
        }
        if(data.arrayAwars.length !== 0){
          const headers = {
            ocid: 'ocid',
            'awards/id': 'awards/id',
            'awards/title': 'awards/title',
            'awards/description': 'awards/description',
            'awards/rationale': 'awards/rationale',
            'awards/status': 'awards/status',
            'awards/date': 'awards/date',
            'awards/value/netAmount': 'awards/value/netAmount',
            'awards/value/amount': 'awards/value/amount',
            'awards/value/currency': 'awards/value/currency',
            'awards/contractPeriod/startDate': 'awards/contractPeriod/startDate',
            'awards/contractPeriod/endDate': 'awards/contractPeriod/endDate'
          };
          exportCSVFile(headers,data.arrayAwars,'6000')
        }
        if(data.arrayAwarsSuppliers.length !== 0){
          const headers = {
            ocid: 'ocid',
            'awards/id': 'awards/id',
            'awards/suppliers/name': 'awards/suppliers/name',
            'awards/suppliers/id': 'awards/suppliers/id'
          };
          exportCSVFile(headers,data.arrayAwarsSuppliers,'6100')
        }
        if(data.arrayAwarsDocuments.length !== 0){
          const headers = {
            ocid: 'ocid',
            'awards/documents/id': 'awards/documents/id',
            'awards/documents/documentType': 'awards/documents/documentType',
            'awards/documents/title': 'awards/documents/title',
            'awards/documents/description': 'awards/documents/description',
            'awards/documents/url': 'awards/documents/url',
            'awards/documents/datePublished': 'awards/documents/datePublished',
            'awards/documents/dateModified': 'awards/documents/dateModified',
            'awards/documents/format': 'awards/documents/format',
            'awards/documents/language': 'awards/documents/language'
          };
          exportCSVFile(headers,data.arrayAwarsDocuments,'6200')
        }
        if(data.arrayAwarsAmendments.length !== 0){
          const headers = {
            ocid: 'ocid',
            'awards/amendments/date': 'awards/amendments/date',
            'awards/amendments/rationale': 'awards/amendments/rationale',
            'awards/amendments/id': 'awards/amendments/id',
            'awards/amendments/description': 'awards/amendments/description'
          };
          exportCSVFile(headers,data.arrayAwarsAmendments,'6300')
        }
        if(data.arrayContracts.length !== 0){
          const headers = {
            ocid: 'ocid',
            'contracts/id': 'contracts/id',
            'contracts/awardID': 'contracts/awardID',
            'contracts/title': 'contracts/title',
            'contracts/description': 'contracts/description',
            'contracts/status': 'contracts/status',
            'contracts/period/startDate': 'contracts/period/startDate',
            'contracts/period/endDate': 'contracts/period/endDate',
            'contracts/value/netAmount': 'contracts/value/netAmount',
            'contracts/value/amount': 'contracts/value/amount',
            'contracts/value/currency': 'contracts/value/currency',
            'contracts/value/exchangeRates/currency':'contracts/value/exchangeRates/currency',
            'contracts/value/exchangeRates/rate': 'contracts/value/exchangeRates/rate',
            'contracts/value/exchangeRates/date': 'contracts/value/exchangeRates/date',
            'contracts/value/exchangeRates/source': 'contracts/value/exchangeRates/source',
            'contracts/dateSigned': 'contracts/dateSigned',
            'surveillanceMechanisms': 'surveillanceMechanisms',
          };
          exportCSVFile(headers,data.arrayContracts,'7000')
        }
        if(data.arrayContractsItems.length !== 0){
          const headers = {
            ocid: 'ocid',
            'contracts/id': 'contracts/id',
            'contracts/awardID': 'contracts/awardID',
            'contracts/items/id': 'contracts/items/id',
            'contracts/items/description': 'contracts/items/description',
            'contracts/items/classification/scheme': 'contracts/items/classification/scheme',
            'contracts/items/classification/id': 'contracts/items/classification/id',
            'contracts/items/classification/description': 'contracts/items/classification/description',
            'contracts/items/quantity': 'contracts/items/quantity',
            'contracts/items/unit/name': 'contracts/items/unit/name',
            'contracts/items/unit/value/amount': 'contracts/items/unit/value/amount',
            'contracts/items/unit/value/netAmount': 'contracts/items/unit/value/netAmount',
            'contracts/items/unit/value/currency': 'contracts/items/unit/value/currency',
            'contracts/items/deliveryLocation/geometry/type': 'contracts/items/deliveryLocation/geometry/type',
            'contracts/items/deliveryLocation/geometry/coordinates': 'contracts/items/deliveryLocation/geometry/coordinates',
            'contracts/items/deliveryAddress/streetAddress': 'contracts/items/deliveryAddress/streetAddress',
            'contracts/items/deliveryAddress/locality': 'contracts/items/deliveryAddress/locality',
            'contracts/items/deliveryAddress/postalCode': 'contracts/items/deliveryAddress/postalCode',
            'contracts/items/deliveryAddress/countryName': 'contracts/items/deliveryAddress/countryName'
          };
          exportCSVFile(headers,data.arrayContractsItems,'7100')
        }
        if(data.arrayContractsdocuments.length !== 0){
          const headers = {
            ocid: 'ocid',
            'contracts/id': 'contracts/id',
            'contracts/awardID': 'contracts/awardID',
            'contracts/documents/id': 'contracts/documents/id',
            'contracts/documents/documentType': 'contracts/documents/documentType',
            'contracts/documents/title': 'contracts/documents/title',
            'contracts/documents/description': 'contracts/documents/description',
            'contracts/documents/url': 'contracts/documents/url',
            'contracts/documents/datePublished': 'contracts/documents/datePublished',
            'contracts/documents/dateModified': 'contracts/documents/dateModified',
            'contracts/documents/format': 'contracts/documents/format',
            'contracts/documents/language': 'contracts/documents/language'
          };
          exportCSVFile(headers,data.arrayContractsdocuments,'7200')
        }
        if(data.arrayContractsAmendments.length !== 0){
          const headers = {
            ocid: 'ocid',
            'contracts/id': 'contracts/id',
            'contracts/awardID': 'contracts/awardID',
            'contracts/amendments/date': 'contracts/amendments/date',
            'contracts/amendments/rationale': 'contracts/amendments/rationale',
            'contracts/amendments/id': 'contracts/amendments/id',
            'contracts/amendments/description': 'contracts/amendments/description'
          };
          exportCSVFile(headers,data.arrayContractsAmendments,'7300')
        }
        if(data.arrayContractsGuarantees.length !== 0){
          const headers = {
            ocid: 'ocid',
            'contracts/id': 'contracts/id',
            'contracts/awardID': 'contracts/awardID',
            'contracts/guarantees/id': 'contracts/guarantees/id',
            'contracts/guarantees/type': 'contracts/guarantees/type',
            'contracts/guarantees/date': 'contracts/guarantees/date',
            'contracts/guarantees/obligations': 'contracts/guarantees/obligations',
            'contracts/guarantees/value/amount': 'contracts/guarantees/value/amount',
            'contracts/guarantees/value/currency': 'contracts/guarantees/value/currency',
            'contracts/guarantees/guarantor/name': 'contracts/guarantees/guarantor/name',
            'contracts/guarantees/guarantor/id': 'contracts/guarantees/guarantor/id',
            'contracts/guarantees/period/startDate': 'contracts/guarantees/period/startDate',
            'contracts/guarantees/period/endDate': 'contracts/guarantees/period/endDate'
          };
          exportCSVFile(headers,data.arrayContractsGuarantees,'7400')
        }
        if(data.arrayContractsImplementation.length !== 0){
          const headers = {
            ocid: 'ocid',
            'contracts/id': 'contracts/id',
            'contracts/awardID': 'contracts/awardID',
            'contracts/implementation/status': 'contracts/implementation/status'
          };
          exportCSVFile(headers,data.arrayContractsImplementation,'8000')
        }
        if(data.arrayContractsImplementationTrans.length !== 0){
          const headers = {
            ocid: 'ocid',
            'contracts/id': 'contracts/id',
            'contracts/awardID': 'contracts/awardID',
            'contracts/implementation/transactions/id': 'contracts/implementation/transactions/id',
            'contracts/implementation/transactions/date': 'contracts/implementation/transactions/date',
            'contracts/implementation/transactions/value/netAmount': 'contracts/implementation/transactions/value/netAmount',
            'contracts/implementation/transactions/value/amount': 'contracts/implementation/transactions/value/amount',
            'contracts/implementation/transactions/value/currency': 'contracts/implementation/transactions/value/currency',
            'contracts/implementation/transactions/payer/name': 'contracts/implementation/transactions/payer/name',
            'contracts/implementation/transactions/payer/id': 'contracts/implementation/transactions/payer/id',
            'contracts/implementation/transactions/payee/id': 'contracts/implementation/transactions/payee/id',
            'contracts/implementation/transactions/payee/name': 'contracts/implementation/transactions/payee/name',
            'contracts/implementation/transactions/paymentMethod': 'contracts/implementation/transactions/paymentMethod',
          };
          exportCSVFile(headers,data.arrayContractsImplementationTrans,'8100')
        }
        if(data.arrayContractsImplementationMilestone.length !== 0){
          const headers = {
            ocid: 'ocid',
            'contracts/id': 'contracts/id',
            'contracts/awardID': 'contracts/awardID',
            'implementation/milestones/id': 'implementation/milestones/id',
            'implementation/milestones/title': 'implementation/milestones/title',
            'implementation/milestones/type': 'implementation/milestones/type',
            'implementation/milestones/description': 'implementation/milestones/description',
            'implementation/milestones/dueDate': 'implementation/milestones/dueDate',
            'implementation/milestones/dateModified': 'implementation/milestones/dateModified',
            'implementation/milestones/status': 'implementation/milestones/status',
          };
          exportCSVFile(headers,data.arrayContractsImplementationMilestone,'8200')
        }
        if(data.arrayContractsImplementationDocuments.length !== 0){
          const headers = {
            ocid: 'ocid',
            'contracts/id': 'contracts/id',
            'contracts/awardID': 'contracts/awardID',
            'implementation/documents/id': 'implementation/documents/id',
            'implementation/documents/documentType': 'implementation/documents/documentType',
            'implementation/documents/title': 'implementation/documents/title',
            'implementation/documents/description': 'implementation/documents/description',
            'implementation/documents/url': 'implementation/documents/url',
            'implementation/documents/datePublished': 'implementation/documents/datePublished',
            'implementation/documents/dateModified': 'implementation/documents/dateModified',
            'implementation/documents/format': 'implementation/documents/format',
            'implementation/documents/language': 'implementation/documents/language'
          };
          exportCSVFile(headers,data.arrayContractsImplementationDocuments,'8300')
        }
        if(data.arrayRelatedProcesses.length !== 0){
          const headers = {
            ocid: 'ocid',
            'relatedProcesses/id': 'relatedProcesses/id',
            'relatedProcesses/relationship': 'relatedProcesses/relationship',
            'relatedProcesses/title':'relatedProcesses/title',
            'relatedProcesses/scheme': 'relatedProcesses/scheme',
            'relatedProcesses/identifier': 'relatedProcesses/identifier',
            'relatedProcesses/uri': 'relatedProcesses/uri',
          };
          exportCSVFile(headers,data.arrayRelatedProcesses,'9000')
        }
        downloadZipCSVFile();
        arrayFilesCSV = new Array();
        document.getElementById('downley').hidden=true;
        document.getElementById('downlo').hidden=false;
        document.getElementById('downley_2').hidden=true;
        document.getElementById('downlo_2').hidden=false;
        document.getElementById('downley_3').hidden=true;
        document.getElementById('downlo_3').hidden=false;
        document.getElementById('downlo_4').hidden=false;
        document.getElementById('downlo_5').hidden=false;
        document.getElementById('downlo_6').hidden=false;
      }
      function convertToCSV(objArray) {
      const array = typeof objArray != "object" ? JSON.parse(objArray) : objArray;
      let str = "";
      for (let i = 0; i < array.length; i++) {
        let line = "";
        for (let index in array[i]) {
          if(index == 'parties/roles'){
            const roles = (array[i][index]).split(',');
            var resRoles = "";
            roles.forEach(rol => {
              if(resRoles == ""){
                resRoles += resRoles+rol;
              }else{
                resRoles +=' | '+resRoles+rol;
              }
            });            
            array[i][index] = resRoles;
          }
          if (line != "") line += ",";
          line += validatesComas(array[i][index]);
        }
        str += line + "\r\n";
        // console.log(`line str ${str}`)
      }
      
      return str;
      } 
      function exportCSVFile(headers, items, fileName) {
        if (headers) {
          items.unshift(headers);
        }
        const jsonObject = JSON.stringify(items);
        const csv = convertToCSV(jsonObject);
        const exportName = fileName + ".csv" || "export.csv";
        const blob = new Blob([csv], { type: "text/csv;charset=utf-8;" });
        var file = new Object({
          exportName: exportName,
          blob: blob
        })
        arrayFilesCSV.push(file);
      }
      function downloadZipCSVFile() {
        if (arrayFilesCSV.length !== 0) {
          var zip = new JSZip();
          var csvs = zip.folder("csvs");
          arrayFilesCSV.forEach(file => {
            csvs.file(file.exportName, file.blob, {base64: true});
          });
          zip.generateAsync({type:"blob"})
              .then(function(content) {
                  saveAs(content, `${new Date().getTime()}_CSV.zip`);
              });
        }else{
          alert('No se encontraron registros.')
        }
      }
      function validatesComas(cadena){
        if(cadena != undefined){
          if (typeof cadena === 'number') {
            return cadena;
          }else{
            var caracteres = Array.from(cadena);
            var cadenaRes = "";
            caracteres.forEach(caracter => {
              if(caracter != ',' && caracter != ';') cadenaRes += caracter;
            });
            return cadenaRes.replace(/(\r\n|\n|92r)/gm,"");
          }
        }else{
          return undefined;
        }
        
      }
      function visualiza_primero(primero,segundo,disabledSelect,metodo,limpiar) {
          if(primero !== null)
          document.getElementById(primero).style.visibility='visible';
          if(primero !== null)
          document.getElementById(primero).style.display='block';
          if(segundo !== null)
          document.getElementById(segundo).style.visibility='hidden';
          if(segundo !== null)
          document.getElementById(segundo).style.display='none';
          if(disabledSelect !== null)
          document.getElementById(disabledSelect).disabled = true;
          if(metodo !== null)
          document.getElementById(metodo).disabled = true;
          if(limpiar !== null)
          document.getElementById(limpiar).hidden = true;
      };
      function visualiza_segundo(primero,segundo,disabledSelect,metodo,limpiar) {
          if(segundo !== null)
          document.getElementById(segundo).style.visibility='visible';
          if(segundo !== null)
          document.getElementById(segundo).style.display='block';
          if(primero !== null)
          document.getElementById(primero).style.visibility='hidden';
          if(primero !== null)
          document.getElementById(primero).style.display='none';
          if(disabledSelect !== null)
          document.getElementById(disabledSelect).disabled = false;
          if(metodo !== null)
          document.getElementById(metodo).disabled = false;
          if(limpiar !== null)
          document.getElementById(limpiar).hidden = false;
      };
      function clean(metodo,resultado_1,resultado_2,clean,disabledSelect,year,leyendo_1,leyendo_2) {
        if(metodo !== null)
        document.getElementById(metodo).value = "";
        if(resultado_1 !== null)
        $(`#${resultado_1}`).text(`Resultado`);
        if(resultado_2 !== null)
        $(`#${resultado_2}`).text(`Resultado`);
        if(clean !== null)
        document.getElementById(clean).hidden=true;
        if(disabledSelect !== null)
        document.getElementById(disabledSelect).selectedIndex=-1;
        if(year !== null)
        document.getElementById(year).selectedIndex=-1;
        if(leyendo_1 !== null)
        document.getElementById(leyendo_1).style.visibility='visible';
        if(leyendo_1 !== null)
        document.getElementById(leyendo_1).style.display='block';
        if(leyendo_2 !== null)
        document.getElementById(leyendo_2).style.visibility='hidden';
        if(leyendo_2 !== null)
        document.getElementById(leyendo_2).style.display='none';
      }
    </script>

</body>

</html>